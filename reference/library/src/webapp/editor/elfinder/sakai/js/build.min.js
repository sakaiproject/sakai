!function(e){e.sakai={},e.sakai.elfinder={}}(jQuery),function(e){e.sakai.elfinder.query=function(){var i={},n=window.location.search.slice(1),o=n.split("&");return e.each(o,function(e,n){var o=n.split("=");i[o[0]]=o[1]}),i}}(jQuery),function(e){e.sakai.tools=["Announcements","Attachments","Forums","Polls"]}(jQuery),function(e){var i=e.sakai.elfinder.ui=function(i){this.footer=function(){var i=e('<div id="sakai-ui-footer"></div>').addClass(n(o.confirmbar)),t=e("<div>OK</div>").addClass(n(o.button,o.ok)),a=e("<div>Cancel</div>").addClass(n(o.button,o.cancel)),r=e("<div><div/>").append(t,a).addClass(n(o.buttons));return i.append(r)},i.append(this.footer()),i.find(o.statusbar).insertAfter(".elfinder-toolbar"),i.find(".elfinder-stat-size, .elfinder-stat-selected").appendTo(o.confirmbar)},n=i.toClass=function(){return e.makeArray(arguments).join(" ").replace(/\./g,"")},o=i.elements={};i.setSaveCloseButtons=function(i){var t=i.find(".ui-button").addClass(n(o.button)),a=e(t[0]).addClass(n(o.cancel)),r=e(t[1]).addClass(n(o.ok)),s=e(t[2]).addClass(n(o.ok));r.insertAfter(s),a.insertAfter(r)},o.footer="#sakai-ui-footer",o.confirmbar="elfinder-confirm-bar",o.buttons=".buttons",o.button=".button",o.ok=".button-ok",o.cancel=".button-cancel",o.statusbar=".elfinder-statusbar",o.confirmbar=".elfinder-confirm-bar"}(jQuery),function(e){var i=2;e.sakai.elfinder.resizer=function(e,n){n.resize(function(){var o=n.height()-i;e.height()!==o&&e.height(o).resize()})}}(jQuery),function(e){var i=e(window),n=e.sakai.elfinder.query(),o="/"+(n.connector||""),t=n.startdir,a=n.langCode;t&&(t=t.split("/"),t=t.filter(function(e){return e}),t=t.slice(1),t="/"+t.join("/"),t=btoa(t),t=t.replace("+","-").replace("/","_").replace("=","."));var r=n.type,s=[];"image"==r?s=["image"]:"flash"==r&&(s=["application/x-shockwave-flash"]);var l={type:"dialog",title:"Help",content:"example"},d=(e.sakai.elfinder.ui,e.sakai.tools);e.sakai.elfinder.options={url:o,startPathHash:t,lang:a,defaultView:"list",getFileCallback:function(e){},onlyMimes:s,height:i.height(),uiOptions:{toolbar:[["help",l],["back","forward"],["reload"],["home","up"],["mkdir","upload"],["open","download","getfile"],["info"],["quicklook"],["copy","cut","paste"],["search"],["view"]],tree:{getClass:function(i){var n="";return i.tool&&e.inArray(i.tool,d)&&(n="sakai-tool-"+i.tool.toLowerCase()),n}}},commandsOptions:{info:{custom:{}},edit:{editors:[]}},resizable:!1}}(jQuery),function(e){var i=e.sakai.elfinder.ui,n=function(){var n,o=!1,t=function(i){var o=n=CKEDITOR.replace(i.id,{startupFocus:!0,fullPage:!0,allowedContent:!0,removePlugins:"resize"}),t=e(i).closest(".elfinder-dialog");t.on("resize",function(e,i){var n=t.find(".ui-dialog-content"),a=n.height()-1,r=n.width();o.resize(r,a)})};return{mimes:["text/html"],load:function(n){var a=e(n).closest(".elfinder-dialog");i.setSaveCloseButtons(a),o?t(n):(e.getScript("//cdn.ckeditor.com/4.5.2/standard/ckeditor.js",function(){t(n)}),o=!0)},close:function(e){},save:function(e){n&&(e.value=n.getData())},focus:function(e){}}}(),o=function(){var n,o="/library/webjars/codemirror/5.6/",t=o+"lib/codemirror.js",a=[],r=function(i,o){var t=e(i),a=t.closest(".elfinder-dialog"),r={lineNumbers:!0};o&&(r.mode=o);var s=n=CodeMirror.fromTextArea(i,r),l=a.find(".ui-dialog-content").addClass("elfinder-codemirror"),d=function(){var e=l.width(),i=l.height();s.setSize(e,i)};a.on("resize",d),d()},s=function(e){return a.indexOf(e)!==-1};return{load:function(n){var l=e(n).closest(".elfinder-dialog");i.setSaveCloseButtons(l);var d=this.file.mime,c=function(){var i=CodeMirror.findModeByMIME(d).mode,t=o+"/mode/"+i+"/"+i+".js";return"null"===i&&a.push(t),s(t)?void r(n,d):void e.getScript(o+"/mode/"+i+"/"+i+".js").done(function(){a.push(t),r(n,d)}).fail(function(){console.log("Failed to load mode for "+i),r(n)})};s(t)?c():(e("head").append(e('<link rel="stylesheet" href="'+o+'lib/codemirror.css">')),e.getScript(t,function(){a.push(t),e.getScript(o+"mode/meta.js",c)}))},close:function(e){},save:function(e){n&&(e.value=n.getValue())},focus:function(e){}}}();e.sakai.elfinder.options.commandsOptions.edit.editors=[n,o]}(jQuery),function(e){var i=e.sakai.elfinder.ui,n=i.elements;e.sakai.elfinder.options.handlers={open:function(i,o){var t=e(n.footer);t.data("cwd",i.data.options.url)},select:function(i,o){var t=i.data.selected,a=e(n.footer);if(t.length)a.data("embed",o.file(t[0]).url),o.exec("getfile",t);else{var r=a.data("cwd");a.data("embed",r)}}};var o;e(document).keydown(function(e){o=13==e.which}).click(function(){o=!1}),e.sakai.elfinder.options.getFileCallback=function(i,t){t.options.commandsOptions.getfile={folders:!1};var a=e(n.footer);a.data("embed",i.url),a.data("file",i),o&&e(n.footer).find(n.ok).click()},e.sakai.elfinder.confirm=function(i){var o=i.find(n.footer),t=e.sakai.elfinder.query().CKEditorFuncNum;o.on("click",".button-ok",function(e){var i=o.data("embed");window.opener.CKEDITOR.tools.callFunction(t,i),window.close()}),o.on("click",".button-cancel",function(e){window.close()})}}(jQuery),function(e){elFinder.prototype.i18.en.messages.kind="Type"}(jQuery),function(e,i){e(function(){var n=e.sakai.elfinder.options,o=e.sakai.elfinder.ui,t=e.sakai.elfinder.resizer,a=e.sakai.elfinder.confirm,r=e("#elfinder"),s=e(i);r.elfinder(n),t(r,s),o(r),a(r)})}(jQuery,window);