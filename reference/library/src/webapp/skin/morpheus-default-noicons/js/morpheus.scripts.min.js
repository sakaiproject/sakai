var MD5=function(s){function L(b,a){return(b<<a)|(b>>>(32-a))
}function K(k,b){var F,a,d,x,c;
d=(k&2147483648);
x=(b&2147483648);
F=(k&1073741824);
a=(b&1073741824);
c=(k&1073741823)+(b&1073741823);
if(F&a){return(c^2147483648^d^x)
}if(F|a){if(c&1073741824){return(c^3221225472^d^x)
}else{return(c^1073741824^d^x)
}}else{return(c^d^x)
}}function r(a,c,b){return(a&c)|((~a)&b)
}function q(a,c,b){return(a&b)|(c&(~b))
}function p(a,c,b){return(a^c^b)
}function n(a,c,b){return(c^(a|(~b)))
}function u(G,F,aa,Z,k,H,I){G=K(G,K(K(r(F,aa,Z),k),I));
return K(L(G,H),F)
}function f(G,F,aa,Z,k,H,I){G=K(G,K(K(q(F,aa,Z),k),I));
return K(L(G,H),F)
}function D(G,F,aa,Z,k,H,I){G=K(G,K(K(p(F,aa,Z),k),I));
return K(L(G,H),F)
}function t(G,F,aa,Z,k,H,I){G=K(G,K(K(n(F,aa,Z),k),I));
return K(L(G,H),F)
}function e(k){var G;
var d=k.length;
var c=d+8;
var b=(c-(c%64))/64;
var F=(b+1)*16;
var H=Array(F-1);
var a=0;
var x=0;
while(x<d){G=(x-(x%4))/4;
a=(x%4)*8;
H[G]=(H[G]|(k.charCodeAt(x)<<a));
x++
}G=(x-(x%4))/4;
a=(x%4)*8;
H[G]=H[G]|(128<<a);
H[F-2]=d<<3;
H[F-1]=d>>>29;
return H
}function B(c){var b="",d="",k,a;
for(a=0;
a<=3;
a++){k=(c>>>(a*8))&255;
d="0"+k.toString(16);
b=b+d.substr(d.length-2,2)
}return b
}function J(b){b=b.replace(/\r\n/g,"\n");
var a="";
for(var k=0;
k<b.length;
k++){var d=b.charCodeAt(k);
if(d<128){a+=String.fromCharCode(d)
}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);
a+=String.fromCharCode((d&63)|128)
}else{a+=String.fromCharCode((d>>12)|224);
a+=String.fromCharCode(((d>>6)&63)|128);
a+=String.fromCharCode((d&63)|128)
}}}return a
}var C=Array();
var P,h,E,v,g,Y,X,W,V;
var S=7,Q=12,N=17,M=22;
var A=5,z=9,y=14,w=20;
var o=4,m=11,l=16,j=23;
var U=6,T=10,R=15,O=21;
s=J(s);
C=e(s);
Y=1732584193;
X=4023233417;
W=2562383102;
V=271733878;
for(P=0;
P<C.length;
P+=16){h=Y;
E=X;
v=W;
g=V;
Y=u(Y,X,W,V,C[P+0],S,3614090360);
V=u(V,Y,X,W,C[P+1],Q,3905402710);
W=u(W,V,Y,X,C[P+2],N,606105819);
X=u(X,W,V,Y,C[P+3],M,3250441966);
Y=u(Y,X,W,V,C[P+4],S,4118548399);
V=u(V,Y,X,W,C[P+5],Q,1200080426);
W=u(W,V,Y,X,C[P+6],N,2821735955);
X=u(X,W,V,Y,C[P+7],M,4249261313);
Y=u(Y,X,W,V,C[P+8],S,1770035416);
V=u(V,Y,X,W,C[P+9],Q,2336552879);
W=u(W,V,Y,X,C[P+10],N,4294925233);
X=u(X,W,V,Y,C[P+11],M,2304563134);
Y=u(Y,X,W,V,C[P+12],S,1804603682);
V=u(V,Y,X,W,C[P+13],Q,4254626195);
W=u(W,V,Y,X,C[P+14],N,2792965006);
X=u(X,W,V,Y,C[P+15],M,1236535329);
Y=f(Y,X,W,V,C[P+1],A,4129170786);
V=f(V,Y,X,W,C[P+6],z,3225465664);
W=f(W,V,Y,X,C[P+11],y,643717713);
X=f(X,W,V,Y,C[P+0],w,3921069994);
Y=f(Y,X,W,V,C[P+5],A,3593408605);
V=f(V,Y,X,W,C[P+10],z,38016083);
W=f(W,V,Y,X,C[P+15],y,3634488961);
X=f(X,W,V,Y,C[P+4],w,3889429448);
Y=f(Y,X,W,V,C[P+9],A,568446438);
V=f(V,Y,X,W,C[P+14],z,3275163606);
W=f(W,V,Y,X,C[P+3],y,4107603335);
X=f(X,W,V,Y,C[P+8],w,1163531501);
Y=f(Y,X,W,V,C[P+13],A,2850285829);
V=f(V,Y,X,W,C[P+2],z,4243563512);
W=f(W,V,Y,X,C[P+7],y,1735328473);
X=f(X,W,V,Y,C[P+12],w,2368359562);
Y=D(Y,X,W,V,C[P+5],o,4294588738);
V=D(V,Y,X,W,C[P+8],m,2272392833);
W=D(W,V,Y,X,C[P+11],l,1839030562);
X=D(X,W,V,Y,C[P+14],j,4259657740);
Y=D(Y,X,W,V,C[P+1],o,2763975236);
V=D(V,Y,X,W,C[P+4],m,1272893353);
W=D(W,V,Y,X,C[P+7],l,4139469664);
X=D(X,W,V,Y,C[P+10],j,3200236656);
Y=D(Y,X,W,V,C[P+13],o,681279174);
V=D(V,Y,X,W,C[P+0],m,3936430074);
W=D(W,V,Y,X,C[P+3],l,3572445317);
X=D(X,W,V,Y,C[P+6],j,76029189);
Y=D(Y,X,W,V,C[P+9],o,3654602809);
V=D(V,Y,X,W,C[P+12],m,3873151461);
W=D(W,V,Y,X,C[P+15],l,530742520);
X=D(X,W,V,Y,C[P+2],j,3299628645);
Y=t(Y,X,W,V,C[P+0],U,4096336452);
V=t(V,Y,X,W,C[P+7],T,1126891415);
W=t(W,V,Y,X,C[P+14],R,2878612391);
X=t(X,W,V,Y,C[P+5],O,4237533241);
Y=t(Y,X,W,V,C[P+12],U,1700485571);
V=t(V,Y,X,W,C[P+3],T,2399980690);
W=t(W,V,Y,X,C[P+10],R,4293915773);
X=t(X,W,V,Y,C[P+1],O,2240044497);
Y=t(Y,X,W,V,C[P+8],U,1873313359);
V=t(V,Y,X,W,C[P+15],T,4264355552);
W=t(W,V,Y,X,C[P+6],R,2734768916);
X=t(X,W,V,Y,C[P+13],O,1309151649);
Y=t(Y,X,W,V,C[P+4],U,4149444226);
V=t(V,Y,X,W,C[P+11],T,3174756917);
W=t(W,V,Y,X,C[P+2],R,718787259);
X=t(X,W,V,Y,C[P+9],O,3951481745);
Y=K(Y,h);
X=K(X,E);
W=K(W,v);
V=K(V,g)
}var i=B(Y)+B(X)+B(W)+B(V);
return i.toLowerCase()
};
$PBJQ("details").details();
$PBJQ(document).ready(function(){updateFooterTime=(function(){if($PBJQ("#preferredTime").length==1){var c=$PBJQ("#preferredTime").data("preferredtzdisplay");
var e=new Date(parseInt($PBJQ("#preferredTime").data("preferredserverdateandgmtoffset")));
var a=e.getTime()-(new Date()).getTime()
}var b=$PBJQ("#serverTime").data("servertzdisplay");
var d=new Date(parseInt($PBJQ("#serverTime").data("serverdateandgmtoffset")));
var f=d.getTime()-(new Date()).getTime();
return function(){var g=new Date((new Date()).getTime()+f);
var h=g.toUTCString().replace(/GMT/,b).replace(/UTC/,b);
$PBJQ("#serverTime").text(h);
if($PBJQ("#preferredTime").length==1){var g=new Date((new Date()).getTime()+a);
var h=g.toUTCString().replace(/GMT/,c).replace(/UTC/,c);
$PBJQ("#preferredTime").text(h)
}setTimeout("updateFooterTime()",1000)
}
})();
if($PBJQ("#serverTime").length==1){updateFooterTime()
}});
var dhtml_view_sites=function(){$PBJQ("#selectSite").addClass("dhtml_more_tabs");
$PBJQ(".more-tab").position();
dhtml_view_sites=function(){if($PBJQ("#selectSite").hasClass("outscreen")){$PBJQ("#selectSite").toggleClass("outscreen");
$PBJQ("#txtSearch").focus();
createDHTMLMask(dhtml_view_sites);
$PBJQ(".selectedTab").bind("click",function(b){dhtml_view_sites();
return false
});
$PBJQ("#selectSite a:first").focus();
$PBJQ("#selectSite a").keydown(function(b){if(b.keyCode==38||b.keyCode==27){b.preventDefault();
closeDrawer()
}});
$PBJQ(".moreSitesLink").keydown(function(b){if(b.keyCode==40){showToolMenu(b,0)
}});
var a=$PBJQ("#txtSearch");
if(a.length){$PBJQ(a[0]).keydown(function(b){if(b.keyCode==9&&b.shiftKey){b.preventDefault()
}})
}else{$PBJQ("#allSites").keydown(function(b){if(b.keyCode==9&&b.shiftKey){b.preventDefault()
}})
}$PBJQ("#otherSiteList > li:last").keydown(function(b){if(b.keyCode==9&&!b.shiftKey){b.preventDefault();
if(a.length){a[0].focus()
}else{$PBJQ("#allSites").focus()
}}})
}else{$PBJQ("#selectSite").toggleClass("outscreen");
removeDHTMLMask();
$PBJQ("#otherSiteTools").remove();
$PBJQ(".selectedTab").unbind("click")
}};
dhtml_view_sites()
};
function closeDrawer(){$PBJQ("#selectSite").toggleClass("outscreen");
removeDHTMLMask();
$PBJQ("#otherSiteTools").remove();
$PBJQ(".selectedTab").unbind("click");
$PBJQ(".moreSitesLink").unbind("keydown");
$PBJQ(".more-tab a").focus()
}function createDHTMLMask(a){$PBJQ("body").append('<div id="portalMask">&nbsp;</div>');
$PBJQ("#portalMask").css("height",browserSafeDocHeight()).css({width:"100%","z-index":1000,top:0,left:0}).bind("click",function(b){a();
return false
});
$PBJQ("#portalMask").bgiframe()
}function removeDHTMLMask(){$PBJQ("#portalMask").remove()
}function showToolMenu(g,h){g.preventDefault();
var l=$PBJQ(g.target);
var j=l.attr("id");
var a=j.replace(/!/g,"\\!").replace(/~/g,"\\~");
$PBJQ(".toolMenus").removeClass("toolMenusActive");
if($PBJQ("."+a).length){$PBJQ("#otherSiteTools").remove()
}else{$PBJQ("#otherSiteTools").remove();
var b='<ul id="otherSiteTools" class="'+j+'" role="menu">';
var i="/direct/site/"+j+"/pages.json";
scroll(0,0);
var k=l.offset();
var f=parseInt($PBJQ("#maxToolsInt").text());
var d=$PBJQ("#maxToolsAnchor").text();
var c='<li class="otherSiteTool"><span><a role="menuitem" href="'+portal.portalPath+"/site/"+j+'" title="'+d+'"><span class="toolMenuIcon icon-sakai-see-all-tools"> </span>'+d+"</a></span></li>";
$PBJQ.getJSON(i,function(e){$PBJQ.each(e,function(m,n){if(m<=f){if(n.toolpopup){b=b+'<li class="otherSiteTool"><span><a role="menuitem"  href="'+n.tools[0].url+'?sakai.popup=yes" title="'+n.title+'" onclick="window.open(\''+n.toolpopupurl+'\');"><span class="toolMenuIcon icon-'+n.tools[0].toolId.replace(/\./gi,"-")+'"> </span>'+n.title+"</a></span></li>"
}else{if(n.tools.length===1){b=b+'<li class="otherSiteTool"><span><a role="menuitem"  href="'+n.tools[0].url+'" title="'+n.title+'"><span class="toolMenuIcon icon-'+n.tools[0].toolId.replace(/\./gi,"-")+'"> </span>'+n.title+"</a></span></li>"
}}}});
if((e.length-1)>f){b=b+c
}b=b+"</ul>";
$PBJQ("#portalOuterContainer").append(b);
$PBJQ("#otherSiteTools").css({top:k.top+28,left:k.left-h});
$PBJQ("#otherSiteTools li a:first").focus();
l.parent().find(".toolMenus").addClass("toolMenusActive");
$PBJQ("#otherSiteTools").keydown(function(m){if(m.keyCode==27){m.preventDefault();
l.focus();
$PBJQ(this).remove();
$PBJQ("."+a).remove();
l.parent().find(".toolMenus").removeClass("toolMenusActive")
}});
addArrowNavAndDisableTabNav($PBJQ("#otherSiteTools"),function(){l.focus();
$PBJQ("."+a).remove();
l.parent().find(".toolMenus").removeClass("toolMenusActive")
})
})
}}$PBJQ(document).ready(function(){if($PBJQ("#eid").length===1){$PBJQ("#eid").focus()
}$PBJQ(".more-tab a").keydown(function(c){if(c.keyCode==40||c.keyCode==38||c.keyCode==27){c.preventDefault();
return dhtml_view_sites()
}});
$PBJQ(".toolMenus").click(function(c){showToolMenu(c,173)
});
var b=portal.siteTitle;
if(b){if(portal.shortDescription){b=b+" ("+portal.shortDescription+")"
}$PBJQ(".portletTitle h2").prepend('<span class="siteTitle">'+b+":</span> ")
}$PBJQ("#imgSearch").click(function(){a()
});
$PBJQ("#txtSearch").keyup(function(c){if(c.keyCode==27){a()
}if($PBJQ("#txtSearch").val().length>0){$PBJQ("#otherSiteList li, .otherSitesCategorList li").hide();
$PBJQ("#otherSitesCategorWrap h4").hide();
$PBJQ("#otherSiteList li a span.fullTitle:Contains('"+$PBJQ("#txtSearch").val()+"')").parent("a").parent("li").show();
$PBJQ(".otherSitesCategorList li a span.fullTitle:Contains('"+$PBJQ("#txtSearch").val()+"')").parent("a").parent("li").show().closest("ul").prev("h4").show();
$PBJQ("#imgSearch").fadeIn("slow")
}if($PBJQ("#txtSearch").val().length==0){a()
}if($PBJQ("#otherSiteList li:visible").length<1&&$PBJQ(".otherSitesCategorList li:visible").length<1){$PBJQ(".norecords").remove();
$PBJQ("#otherSiteSearch #noSearchResults").fadeIn("slow")
}});
$PBJQ.expr[":"].Contains=function(d,e,c){return $PBJQ(d).text().toUpperCase().indexOf(c[3].toUpperCase())>=0
};
function a(){$PBJQ("#txtSearch").val("");
$PBJQ("#otherSiteList li").show();
$PBJQ(".otherSitesCategorList li").show();
$PBJQ("#otherSitesCategorWrap h4").show();
$PBJQ("#noSearchResults").fadeOut();
$PBJQ("#imgSearch").fadeOut();
$PBJQ("#txtSearch").focus()
}$PBJQ("#presenceToggle").click(function(c){c.preventDefault();
$PBJQ("#presenceArea").toggle()
});
$PBJQ(".trayPopupClose").click(function(c){c.preventDefault();
$PBJQ(this).closest(".trayPopup").hide()
});
if($PBJQ("a.tool-directurl").length){$PBJQ("a.tool-directurl").cluetip({local:true,arrows:true,cluetipClass:"jtip",sticky:true,cursor:"pointer",activation:"click",closePosition:"title",closeText:'<img src="/library/image/silk/cross.png" alt="close">'})
}$PBJQ("#toggleSubsitesLink").click(function(f){var d=$PBJQ(this);
if($PBJQ("#subSites").css("display")=="block"){$PBJQ("#subSites").hide()
}else{var c=d.position();
$PBJQ("#subSites").css({position:"absolute",display:"block",left:c.left+d.width()+14+"px",top:c.top+"px"})
}})
});
function publishSite(b){var a="/direct/site/"+b+"/edit";
var c=$PBJQ.ajax({type:"POST",data:"published=true",url:a,success:function(){location.reload()
}}).responseText
}function toggleToolsNav(){event.preventDefault();
$PBJQ("body").toggleClass("toolsNav--displayed")
}function toggleSitesNav(){event.preventDefault();
$PBJQ("body").toggleClass("sitesNav--displayed");
$PBJQ("#linkNav .Mrphs-sitesNav__drop").removeClass("is-clicked");
$PBJQ("#linkNav .Mrphs-sitesNav__submenu").removeClass("is-visible")
}$PBJQ(".js-toggle-sites-nav","#skipNav").on("click",toggleSitesNav);
$PBJQ(".js-toggle-tools-nav","#skipNav").on("click",toggleToolsNav);
var sessionId="current";
var sessionTimeOut;
var timeoutDialogEnabled=false;
var timeoutDialogWarningTime;
var timeoutLoggedoutUrl;
var timeoutPortalPath;
$PBJQ(document).ready(function(){if(portal.loggedIn&&portal.timeoutDialog){setTimeout("setup_timeout_config();",60000)
}});
var setup_timeout_config=function(){timeoutDialogEnabled=portal.timeoutDialog.enabled;
timeoutDialogWarningTime=portal.timeoutDialog.seconds;
timeoutLoggedoutUrl=portal.loggedOutUrl;
timeoutPortalPath=portal.portalPath;
if(timeoutDialogEnabled==true){poll_session_data();
fetch_timeout_dialog()
}};
var poll_session_data=function(){$PBJQ.ajax({url:"/direct/session/"+sessionId+".json?auto=true&_="+(new Date()).getTime(),dataType:"json",success:function(b){b.maxInactiveInterval=b.maxInactiveInterval*1000;
if(b.active&&b.userId!=null&&b.lastAccessedTime+b.maxInactiveInterval>b.currentTime){var a=b.lastAccessedTime+b.maxInactiveInterval-b.currentTime;
if(a<timeoutDialogWarningTime*1000){min=Math.round(a/(1000*60));
show_timeout_alert(min);
clearTimeout(sessionTimeOut);
sessionTimeOut=setTimeout("poll_session_data()",1000*60)
}else{clearTimeout(sessionTimeOut);
sessionTimeOut=setTimeout("poll_session_data()",(a-timeoutDialogWarningTime*1000))
}}else{if(b.userId==null){location.href=timeoutLoggedoutUrl
}else{sessionTimeOut=setTimeout("poll_session_data()",1000*10)
}}},error:function(c,a,b){}})
};
function keep_session_alive(){dismiss_session_alert();
$PBJQ.get(timeoutPortalPath)
}var dismiss_session_alert=function(){removeDHTMLMask();
$PBJQ("#timeout_alert_body").remove()
};
var timeoutDialogFragment;
function fetch_timeout_dialog(){$PBJQ.ajax({url:"/portal/timeout?auto=true",cache:true,dataType:"text",success:function(a){timeoutDialogFragment=a
},error:function(c,a,b){timeoutDialogEnabled=false
}})
}function show_timeout_alert(b){if(!timeoutDialogEnabled){return
}if(!$PBJQ("#portalMask").get(0)){createDHTMLMask(dismiss_session_alert);
$PBJQ("#portalMask").css("z-index",1000)
}if($PBJQ("#timeout_alert_body").get(0)){$PBJQ("#timeout_alert_body span").html(b);
$PBJQ("#timeout_alert_body span").css("top",(f_scrollTop()+100)+"px")
}else{var a=timeoutDialogFragment.replace("{0}",b);
$PBJQ("body").append(a)
}}function toggleShortUrlOutput(b,c,a){if($PBJQ(c).is(":checked")){$PBJQ.ajax({url:"/direct/url/shorten?path="+encodeURI(b),success:function(d){$PBJQ("."+a).val(d)
}})
}else{$PBJQ("."+a).val(b)
}}$PBJQ(document).ready(function(){$PBJQ(".Mrphs-toolTitleNav__link--directurl").click(function(b){var a=$PBJQ(this).position();
$PBJQ(this).siblings(".Mrphs-directUrl").toggleClass("active").css({left:a.left+"px"});
b.preventDefault()
})
});
var setupSkipNav=function(){$PBJQ("#skipNav a.Mrphs-skipNav__link").click(function(){var a=$PBJQ(this).attr("href");
$PBJQ(a).attr("tabindex","-1").focus()
})
};
var setupSiteNav=function(){$PBJQ("ul.Mrphs-sitesNav__menu").each(function(){$PBJQ(this).keydown(function(a){if(a.keyCode==27){$PBJQ(this).parent().children("a").focus();
$PBJQ(this).toggleClass("is-visible")
}});
$PBJQ(this).children("li:last").addClass("is-last-item")
});
$PBJQ("ul.Mrphs-sitesNav__menu > li").mouseleave(function(){$PBJQ(this).find("ul").toggleClass("is-visible")
});
fixTopNav=function(a){if(a.keyCode==40){a.preventDefault();
$PBJQ("#selectSite").hide();
$PBJQ(this).parent().find(".Mrphs-sitesNav__drop").trigger("click",[true])
}else{if(a.keyCode==27){$PBJQ(this).parent().children("a").focus();
$PBJQ(this).toggleClass("is-visible")
}}};
if($PBJQ(document).on){$PBJQ(document).on("keydown",".Mrphs-sitesNav__menu > li.Mrphs-sitesNav__menuitem > a",fixTopNav)
}else{$PBJQ(".Mrphs-sitesNav__menu > .Mrphs-sitesNav__menuitem > a").live("keydown",fixTopNav)
}$PBJQ("ul.Mrphs-sitesNav__menu > li").mouseleave(function(){$PBJQ(this).find("ul").toggleClass("is-visible")
});
$PBJQ("ul.Mrphs-sitesNav__menu li span.Mrphs-sitesNav__drop").click(function(g,d){$PBJQ(this).toggleClass("is-clicked");
g.preventDefault();
var i=$PBJQ(g.target);
if(i.next("ul").length){i.next("ul").toggleClass("is-visible");
if(d){i.next("ul").find("a:first").focus()
}}else{var k='<ul class="Mrphs-sitesNav__submenu is-visible" role="menu">';
var a=i.attr("data-site-id");
var f=parseInt($PBJQ("#linkNav").attr("data-max-tools-int"));
var c=$PBJQ("#linkNav").attr("data-max-tools-anchor");
var b='<li class="Mrphs-sitesNav__submenuitem"><a role="menuitem" href="'+portal.portalPath+"/site/"+a+'" title="'+c+'"><span class="toolMenuIcon icon-sakai-see-all-tools"></span>'+c+"</a></li>";
var h="/direct/site/"+i.attr("data-site-id")+"/pages.json";
var j=window.location.pathname.split("/").pop();
$PBJQ.ajax({url:h,dataType:"json",success:function(e){$PBJQ.each(e,function(m,n){if(m<=f){if(n.toolpopup){k=k+'<li class="Mrphs-sitesNav__submenuitem" ><a role="menuitem" href="'+n.tools[0].url+'?sakai.popup=yes" title="'+n.title+'" onclick="window.open(\''+n.toolpopupurl+'\');"><span class="toolMenuIcon icon-'+n.tools[0].toolId.replace(/\./gi,"-")+'"></span>'+n.title+"</a></li>"
}else{if(n.tools.length>=1){var l="";
if(j==n.tools[0].id){var l=" is-current"
}k=k+'<li class="Mrphs-sitesNav__submenuitem'+l+'"><a role="menuitem" href="'+n.tools[0].url+'" title="'+n.title+'"><span class="toolMenuIcon icon-'+n.tools[0].toolId.replace(/\./gi,"-")+'"></span>'+n.title+"</a></li>"
}}}});
if((e.length-1)>f){k=k+b
}k=k+"</ul>";
i.after(k);
if(d){i.next("ul").find("a:first").focus()
}addArrowNavAndDisableTabNav($PBJQ(".Mrphs-sitesNav__submenu"))
},error:function(m,e,l){}})
}}).hover(function(){$PBJQ(this).toggleClass("Mrphs-sitesNav__drop--hover")
})
};
function addArrowNavAndDisableTabNav(a,b){a.find("li a").attr("tabindex","-1").keydown(function(g){var f=$PBJQ(g.target);
if(g.keyCode==40){g.preventDefault();
var c=f.parent().parent().next();
if(c[0]===undefined){a.slideUp("fast");
if(b!==undefined){b()
}else{f.parent().parent().parent().parent().children("a").focus()
}}else{c.find("a").focus()
}}else{if(g.keyCode==9){a.slideUp("fast")
}else{if(g.keyCode==38){g.preventDefault();
var d=f.parent().parent().prev();
if(d[0]===undefined){a.slideUp("fast");
if(b!==undefined){b()
}else{f.parent().parent().parent().parent().children("a").focus()
}}else{d.find("a").focus()
}}}}})
}function toggleMinimizeNav(){$PBJQ("#container").toggleClass("toggleNav--minimized");
var b=$PBJQ(this);
var a=$PBJQ(".accessibility-btn-label",b);
b.toggleClass("min max");
if(a.text()==b.data("title-expand")){a.text(b.data("text-original"));
b.attr("title",(b.data("text-original")));
b.attr("aria-pressed",true);
document.cookie="sakai_nav_minimized=false; path=/"
}else{b.data("text-original",a.text());
a.text(b.data("title-expand"));
b.attr("title",(b.data("title-expand")));
b.attr("aria-pressed",false);
document.cookie="sakai_nav_minimized=true; path=/"
}}$PBJQ(".js-toggle-nav").on("click",toggleMinimizeNav);
function updatePresence(){$PBJQ.ajax({url:sakaiPresenceFragment,cache:false,success:function(g){var f=g.indexOf("<ul");
if(f<1){$PBJQ("#presenceCount").html(" ");
$PBJQ("#presenceCount").removeClass("present").addClass("empty");
location.reload();
return
}g=g.substr(f);
var e=g;
var b="<li";
var a=0;
for(var d=0;
d<e.length;
d++){if(b==e.substr(d,b.length)){a++
}}if(a>1){$PBJQ("#presenceCount").html(a+"");
$PBJQ("#presenceCount").removeClass("empty").addClass("present")
}else{if(a==1){$PBJQ("#presenceCount").html(a+"");
$PBJQ("#presenceCount").removeClass("present").addClass("empty")
}else{$PBJQ("#presenceCount").html(" ");
$PBJQ("#presenceCount").removeClass("present").addClass("empty")
}}$PBJQ("#presenceIframe").html(g);
var c=$PBJQ(".nav-selected .icon-sakai-chat").attr("href");
$PBJQ("#presenceIframe .presenceList li.inChat span").wrap('<a href="'+c+'"></a>');
sakaiLastPresenceTimeOut=setTimeout("updatePresence()",30000)
},error:function(b,a){sakaiLastPresenceTimeOut=setTimeout("updatePresence()",60000)
}})
}function toggleUserNav(){event.preventDefault();
$PBJQ(".Mrphs-userNav__subnav").toggleClass("is-hidden")
}$PBJQ(".js-toggle-user-nav a#loginUser","#loginLinks").on("click",toggleUserNav);
$PBJQ(".js-toggle-user-nav .Mrphs-userNav__drop","#loginLinks").on("click",toggleUserNav);
function f_scrollTop(){return f_filterResults(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)
}function f_filterResults(d,b,a){var c=d?d:0;
if(b&&(!c||(c>b))){c=b
}return a&&(!c||(c>a))?a:c
}$PBJQ(document).ready(function(){var a=function(){var b=/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;
$PBJQ("#Mrphs-xlogin #eid").focusout(function(){if(b.test($PBJQ(this).val())){$PBJQ("#Mrphs-xlogin #gravatar").attr("src","http://www.gravatar.com/avatar/"+MD5($PBJQ(this).val().toLowerCase()));
$PBJQ("#Mrphs-xlogin #gravatar").parent().addClass("gravatar")
}else{$PBJQ("#Mrphs-xlogin #gravatar").removeAttr("src");
$PBJQ("#Mrphs-xlogin #gravatar").parent().removeClass("gravatar")
}})
};
if($PBJQ("#Mrphs-xlogin").length==1){a()
}if($PBJQ("#loginLink2").length==1){$PBJQ("#loginLink2").click(function(b){$PBJQ("body").append('<div id="Mrphs-xlogin-container" />');
$PBJQ("#Mrphs-xlogin-container").load("/portal/xlogin #Mrphs-xlogin",function(){$PBJQ("#Mrphs-xlogin-container").addClass("loaded");
$PBJQ("#Mrphs-xlogin").addClass("loadedByAjax");
a()
});
$(".Mrphs-portalWrapper").addClass("blurry");
$PBJQ("body").append('<div id="loginPortalMask" />');
$PBJQ("#loginPortalMask").bgiframe();
$PBJQ("#loginPortalMask").click(function(){$PBJQ("#loginPortalMask").remove();
$PBJQ("#Mrphs-xlogin-container").remove();
$(".Mrphs-portalWrapper").removeClass("blurry")
});
b.preventDefault()
})
}});
WebFontConfig={google:{families:["Open+Sans:300italic,400italic,600italic,700italic,400,600,300,700:latin"]}};
(function(){var a=document.createElement("script");
a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";
a.type="text/javascript";
a.async="true";
var b=document.getElementsByTagName("script")[0];
b.parentNode.insertBefore(a,b)
})();