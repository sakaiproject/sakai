<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>2. Set up Environment</title>
<link rel="stylesheet" href="styles/pos.css" type="text/css">
<link rel="stylesheet" href="styles/styles.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.70.0">
<link rel="start" href="install-overview.html" title="Installation Guide">
<link rel="up" href="install-overview.html" title="Installation Guide">
<link rel="prev" href="install-overview.html" title="Installation Guide">
<link rel="next" href="install-build.html" title="3. Build and Deploy">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div id="frame">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">2. Set up Environment</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="install-overview.html">Prev</a> </td>
<th width="60%" align="center"> </th>
<td width="20%" align="right"> <a accesskey="n" href="install-build.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title">
<a name="install-env"></a>2. Set up Environment</h2></div></div></div>

        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-jinstall"></a>2.1. Verify Java Installation</h3></div></div></div>

            <p>Check to see if you have Java (version 1.4.2 or higher) installed on your system
                by running the following command (sample output from a *nix system):</p>
            <pre class="screen">
$ java -version
java version "1.5.0_06"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)
Java HotSpot(TM) Server VM (build 1.5.0_06-b05, mixed mode)</pre>
            <p>If you're going to be building the source (i.e. if you chose the source install)
                then you'll want to make sure that you have also installed the full J2SE, and not
                just the JRE.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">JRE vs. JDK vs. J2SE vs. J2EE</h3>

                <p>If you're unfamiliar with the Java world, you may find the acronyms for
                    various Java environments a little mysterious. The JRE is simply the "runtime
                    environment" which allows you to execute compiled Java bytecode, and for many
                    platforms this is all you usually get by default - for the very good reason that
                    the average user just wants to run programs, and doesn't need to be building
                    code. The JRE is what Tomcat needs to start up, and if all you're installing is
                    the Sakai demo or binary, then the JRE will suffice for you.</p>
                <p> To build the Sakai source, however, you'll need the JDK, which stands for
                    "Java Developer's Kit." To both build and run Sakai you'll therefore need a
                    combination of both the JDK and the JRE, and, happily, Sun makes this available
                    as a unit: the J2SE (the "Java 2 Standard Edition").</p>
                <p>If you go to the Sun site for a download, you may also run across the J2EE
                    (the "Enterprise Edition"), or even the J2ME (the "Micro Edition"). Don't
                    trouble yourself with these, unless you know of a particular reason why you may
                    want them - neither is necessary for a Sakai installation.</p>
            </div>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-jenv"></a>2.2. Verify Java Environment Variables</h3></div></div></div>

            <p>There are three Java environment variables you'll want to set for everything to
                function as it should, and though some of them may have already been set by your
                Java installation (depending on your platform), you'll want to double-check them
                all. You can also look at the <a href="http://java.sun.com/j2se/1.5.0/install.html" target="_top">Sun Java Installation
                    Instructions</a> page at the Java web site for further details.</p>
            <p>First you'll need to set the <span><strong class="command">JAVA_HOME</strong></span> environment variable to
                point to the base directory of your Java installation, which will enable Tomcat to
                find it. In UNIX operating systems you typically modify a startup file like
                    <code class="filename">~/.bash_login</code> to set and export these shell variables,
                while for Windows XP you would go to<span class="emphasis"><em>Start -&gt; Control Panel -&gt; System -&gt;
                    Advanced -&gt; Environment Variables</em></span> and then set them to point to the
                correct locations through the text fields of the GUI (samples below):</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows:</span></td>
<td>
                        <p> Set the (or create a new) environment variable
                            <span><strong class="command">JAVA_HOME</strong></span> to <span><strong class="command">C:\jdk1.5.0_06</strong></span>.
                        </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix:</span></td>
<td>
                        <p>
                            <span><strong class="command">export JAVA_HOME=/usr/java/java-current</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">JRE_HOME</h3>

                <p>If your machine has already set JRE_HOME for any reason, or if you want to be
                    sure to be using a particular JRE - in the event that you have more than one JRE
                    installed on your machine - then you'll want to set the JRE_HOME variable as
                    well. JRE_HOME is what Tomcat uses when it starts up, but it defaults to use
                    JAVA_HOME if JRE_HOME is not set. For most people, then, setting JAVA_HOME will
                    cover both cases sufficiently.</p>
            </div>
            <p>Next you'll want to append to the PATH variable the location of Java commands:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows:</span></td>
<td>
                        <p> Append the string <span><strong class="command">;C:\jdk1.5.0_06\bin</strong></span> to the end
                            of the system variable named Path. </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac:</span></td>
<td>
                        <p> Not necessary. </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">*nix:</span></td>
<td>
                        <p>
                            <span><strong class="command">export PATH=$PATH:$JAVA_HOME/bin/</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>Finally, you'll need to set an environment variable that will increase the size
                and performance of your JVM ("Java Virtual Machine": the default JVM settings are
                unfortunately not sufficient for Sakai), and the variable is named
                    <span><strong class="command">JAVA_OPTS</strong></span>. The value suggested below should be suitable for
                developers or demo installations.</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows:</span></td>
<td>
                        <p> Create a new environment variable <span><strong class="command">JAVA_OPTS</strong></span> to
                            hold the value "<span><strong class="command">-server -Xmx512m -Xms512m -XX:PermSize=128m
                                -XX:MaxPermSize=196m -XX:NewSize=192m
                            -XX:MaxNewSize=384m</strong></span>". </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix:</span></td>
<td>
                        <p>
                            <span><strong class="command">export JAVA_OPTS="-server -Xmx512m -Xms512m -XX:PermSize=128m
                                -XX:MaxPermSize=196m -XX:NewSize=192m -XX:MaxNewSize=384m"</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">More on JVM Tuning</h3>

                <p>The above <span><strong class="command">JAVA_OPTS</strong></span> settings are, it must be emphasized
                    once again, minimal. For settings more suitable for production servers, see the
                        <a href="install-config.html#install-config-jvm" title="4.4. JVM Tuning">JVM Tuning</a> section of
                    Post-Installation Configuration.</p>
            </div>
            <p>You should test that these variables are set correctly. In both Windows XP and
                *nix operating systems you can simply start a new shell and type the
                <span><strong class="command">set</strong></span> command to see your environment variables.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-tinstall"></a>2.3. Install Tomcat</h3></div></div></div>

            <p>Sakai 2.2.0 was QA'ed with Tomcat 5.5.17, and so that's the version we recommend,
                although the latest stable version will most likely not present problems. Tomcat can
                be downloaded as a binary from <a href="http://tomcat.apache.org/download-55.cgi" target="_top">http://tomcat.apache.org/download-55.cgi</a>. The distribution you want is
                the one labeled <span class="emphasis"><em>Core</em></span>, along with the <span class="emphasis"><em>JDK 1.4
                    Compatibility Package</em></span> (even if you're using Java 1.5, some portions
                of the Sakai code will require the compatibility package, and Sakai won't start up
                without it). The Tomcat 5.5 instructions will tell you that Java 1.5 is required,
                but it's not, so long as you have the 1.4 Compatibility package.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Tomcat on Windows</h3>

                <p>Windows users have the option of either downloading an .exe Tomcat installer
                    (for installing Tomcat as a service) or a .zip binary. Although either may
                    serve, they are however not entirely equivalent when it comes to operational
                    details, and for brevity's sake it's recommended that you grab the .zip. Sakai
                    requires some tuning of the JVM, and the service install manages these settings
                    through the registry rather than environment variables (see Tomcat installation
                    instructions on the Apache site if you're committed to installing Tomcat as a
                    service).</p>
            </div>
            <p>Unpack the Tomcat archive at your desired location, and unpack the compatibility
                package directly on top of it. From this point forward these instructions will refer
                to the top-level Tomcat directory (e.g.
                <code class="filename">/usr/local/apache-tomcat-5.5.17</code>) as
                <span><strong class="command">$CATALINA_HOME</strong></span>. You may set this as an environment variable for
                convenience's sake, but this is not required. Make sure that you have write
                permissions to the Tomcat files and directories before proceeding, or you may later
                run into errors during the build phase.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-tconfig"></a>2.4. Configure Tomcat</h3></div></div></div>

            <p>Sakai supports UTF-8, allowing for non-Roman characters, but this requires that
                Tomcat be configured to accept UTF-8 URLs since it ships with ISO-8859-1 as the
                default URL encoding. To change this setting, edit
                    <code class="filename">$CATALINA_HOME/conf/server.xml</code>. Add the attribute
                    <span><strong class="command">URIEncoding="UTF-8"</strong></span> to the &lt;connector&gt; element.
                For example:</p>
            <pre class="screen">
&lt;Connector port="8080" maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
enableLookups="false" redirectPort="8443" acceptCount="100" debug="0"
connectionTimeout="20000" disableUploadTimeout="true" URIEncoding="UTF-8"/&gt;</pre>
            <p>If you want to run Tomcat on different ports than the defaults, this would also be
                a good time to make those changes in the <code class="filename">server.xml</code> file. See
                    <a href="http://tomcat.apache.org/tomcat-5.5-doc/config/http.html" target="_top">Tomcat
                    configuration</a> documentation for more details.</p>
            <p> If you're going to run Tomcat as a standalone web server (i.e. if you're not
                going to connect it to the Apache web server) then you'll want to make a further
                minor change that may spare some confusion later. The <code class="filename">ROOT</code>
                webapp is the one served up when a request is made to your Tomcat's root URL, and so
                if you want users to be re-directed automatically to the Sakai application, you'll
                want to insert an <code class="filename">index.html</code> file into
                <code class="filename">webapps/ROOT</code> that prompts this re-direction. It should look
                something like: </p>
            <pre class="screen">
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="refresh" content="0;url=/portal"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        redirecting to /portal ...
    &lt;/body&gt;
&lt;/html&gt;</pre>
            <p>If you don't make this change you (and your users) will need to append
                    '<span><strong class="command">/portal</strong></span>' to the URL entered to access Sakai each time. If
                you intend to connect Tomcat with Apache, you can handle this issue as a matter of
                Apache configuration, which is however outside the scope of this document.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-minstall"></a>2.5. Install Maven</h3></div></div></div>

            <p>Maven is the build tool used by Sakai, and the latest stable release (currently
                1.0.2) can be downloaded from <a href="http://maven.apache.org/start/download.html" target="_top">
                    http://maven.apache.org/start/download.html</a></p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Newer versions of Maven</h3>

                <p>It's important that Maven 1.0.2 be used. There are betas for Maven 1.1 and
                    Maven 2.0 currently available, but neither will work for Sakai 2.2. Many plugins
                    have not yet been adapted for the new Maven architecture.</p>
            </div>
            <p>Choose a location for Maven, and unpack the archive there. You will have a
                top-level directory named <span><strong class="command">maven-1.0.2</strong></span>.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="install-env-mconfig"></a>2.6. Configure Maven</h3></div></div></div>

            <p>To use Maven you'll need to set two more environment variables and then create a
                local repository using a script provided by Maven. Just as with the Java variables,
                    <span><strong class="command">MAVEN_HOME</strong></span> should be set, and then Maven's binary commands
                should be added to the Path:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows:</span></td>
<td>
                        <p> Create a new <span><strong class="command">MAVEN_HOME</strong></span> environment variable to
                                <span><strong class="command">C:\maven-1.0.2</strong></span>. Then append to the PATH variable
                                <span><strong class="command">;C:\maven-1.0.2\bin</strong></span>
                        </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix:</span></td>
<td>
                        <p>
                            <span><strong class="command">export MAVEN_HOME=/usr/local/maven; export
                                PATH=$PATH:$MAVEN_HOME/bin</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>Next you'll want to create your local maven repository in your home directory by
                running the following command:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows:</span></td>
<td>
                        <p>
                            <span><strong class="command">install_repo.bat
                            %HOMEDRIVE%%HOMEPATH%\.maven\repository</strong></span>
                        </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix:</span></td>
<td>
                        <p>
                            <span><strong class="command">install_repo.sh $HOME/.maven/repository</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Home Directories in Windows</h3>

                <p>You may not often deal with the notion of the home directory on Windows
                    systems, but it's still there. By default its location is <code class="filename">C:\Documents
                        and Settings\yourusername</code>. Windows also establishes it through
                    environment variables which you've just seen above - the combination of your
                    "home drive" location and your "home path" location:
                        <span><strong class="command">%HOMEDRIVE%%HOMEPATH%</strong></span> (The %-sign is how Windows brackets
                    environment variables).</p>
            </div>
            <p>Finally, you'll need to create a build properties file in your home directory
                which will define some basic parameters for your Sakai build. Simply create a new
                text file with the filename <code class="filename">build.properties</code> in your home
                directory, and paste in the following contents:</p>
            <pre class="screen">
maven.repo.remote=http://source.sakaiproject.org/maven/
maven.tomcat.home=/usr/local/tomcat/</pre>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">build.properties syntax</h3>

                <p>Maven is very sensitive to the syntax of the build.properties file. Be sure
                    not to omit the trailing slashes as shown above, and be sure to change the value
                    of <span class="emphasis"><em>maven.tomcat.home</em></span> to match the path to your Tomcat
                    installation.</p>
                <p>Further, if you are running on Windows special care is needed in identifying
                    your tomcat home. Maven wants Unix-style forward slashes, "/", and is confused
                    by Windows-style backslashes "\". If you have your tomcat located in
                        <span class="emphasis"><em>c:\tomcat</em></span>, for example, you need to identify it like
                    this:</p>
                <pre class="screen">maven.tomcat.home=c:/tomcat/</pre>
            </div>
            <p>Finally, to confirm that you can start Maven, run the command <span><strong class="command">maven
                -v</strong></span>. This should start maven and cause it to report its version. At this
                point your environment is prepared to build and deploy the Sakai source code.</p>
        </div>
    </div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="install-overview.html">Prev</a> </td>
<td width="20%" align="center"> </td>
<td width="40%" align="right"> <a accesskey="n" href="install-build.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Installation Guide </td>
<td width="20%" align="center"><a accesskey="h" href="install-overview.html">Home</a></td>
<td width="40%" align="right" valign="top"> 3. Build and Deploy</td>
</tr>
</table>
</div>
<br clear="all"></div>
</body>
</html>
