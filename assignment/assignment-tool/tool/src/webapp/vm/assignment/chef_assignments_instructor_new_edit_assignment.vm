<!-- $Id$ -->
<!-- start: chef_assignments_instructor_new_edit_assignment.vm  -->
##Defining macro to repeat buttons at the top and bottom of the page
#macro(buttonBar $submitnotif)
	<div class="act">
		<input accesskey="s" type="button" class="active" name="post" value="$tlang.getString("gen.pos")"
				onclick="javascript:document.newAssignmentForm.onsubmit();showNotif('$submitnotif','post','newAssignmentForm');document.getElementById('option').value='post';document.newAssignmentForm.submit();return false;" />
		<input accesskey="v" type="button" name="preview" value="$tlang.getString("gen.pre")"
				onclick="javascript:document.newAssignmentForm.onsubmit();showNotif('$submitnotif','preview','newAssignmentForm');document.getElementById('option').value='preview';document.newAssignmentForm.submit();return false;" />
		#if (!($!assignment && !$assignment.draft))
			<input accesskey="d" type="button" name="save" value="$tlang.getString("gen.savdra")"
				onclick="javascript:document.newAssignmentForm.onsubmit();showNotif('$submitnotif','save','newAssignmentForm');document.getElementById('option').value='save';document.newAssignmentForm.submit();return false;" />
		#end
		<input accesskey="x" type="button" name="cancel" value="$tlang.getString("gen.can")"
				onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='canceledit';document.newAssignmentForm.submit();return false;" />
		<span id="$submitnotif" style="visibility:hidden">$tlang.getString("gen.proces")</span>
	</div>
#end
##<!-- $Header: Exp $ -->
## Assignments - Instructor new Assignment view
#set( $H = '-' )
<!-- jQuery already loaded in assignment_chef_header -->
<link href="/library/js/jquery/ui/1.11.3/themes/ui-lightness/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/sakai-assignment-tool/css/assignment.css" type="text/css" rel="stylesheet" />

<script type="text/javascript">
$(document).ready(function() {
 	setupAssignNew();
 	#if($turnitin_forceSingleAttachment)
	 	$("#new_assignment_use_review_service").click(function (){
	 		var checked = this.checked;
	 		if(checked){
	 			$("#subType").val(5);
	 		}
	 		$("#subType > option").each(function(){
	 			if(checked){
	 				if($(this).val() != 5){
	 					$(this).prop('disabled', 'disabled');
	 				}
	 			}else{
	 				$(this).removeProp('disabled');
	 			
	 			}
	 		});
	 	});
 	#end
	SetMaxPoint(document.getElementById('$name_GradeType'), document.getElementById('$name_GradePoints'));
});
</script>

<style type="text/css">
	.extraNode {
		border:1px solid #69d;
		padding: 0  1.5em 1em 1.5em;
		width:50%;
		min-width:500px;
	}
	.extraNodeLink{
		cursor:pointer;
	}
	.extraNode legend{
		padding:0 .5em;
		color:#555
	}
	.userList {
		margin-left:36px !important
	}
	.userList .selectedItem{
		background:#def;
		color:#000;
		font-weight:bold
	}
	.userList li label:hover{
		cursor:pointer;
		background:#ffe
	}		

	fieldset .alertMessageInline,fieldset .alertMessage {
		border:none
	}

	.smallMatches{
		background-color: lightyellow;
		border-style: solid;
		border-width: 1px;
		border-color: lightgray;
		padding: 1em 1em 1em 2em;
	}
</style>
<script type="text/javascript">
    function SetMaxPoint(obj_option, obj_textfield)
    {
		if (obj_option === null || obj_textfield === null)
		{
			return;
		}

		if(obj_option.value==3)
		{ 
			obj_textfield.disabled = false;
			obj_textfield.style.backgroundColor = 'white';
			document.forms[0].new_assignment_grade_points.focus();
			obj_textfield.style.backgroundColor = '#ffe';
			document.getElementById('req-$name_GradePoints').style.display="inline";
		}
		else
		{ 
			obj_textfield.disabled = true;
			obj_textfield.style.backgroundColor = '#eee';
			document.getElementById('req-$name_GradePoints').style.display="none";
			document.getElementById('new_assignment_grade_points').value="";
		}
	}

	#*
	## This function is deprecated
		function SetCloseDate(obj_checkbox, obj_1, obj_2, obj_3, obj_4, obj_5, obj_6)
		{
			if (obj_checkbox.checked)
			{
				obj_1.disabled = false;
				obj_2.disabled = false;
				obj_3.disabled = false;
				obj_4.disabled = false;
				obj_5.disabled = false;
				obj_6.disabled = false;
			}
			else
			{
				obj_1.disabled = true;
				obj_2.disabled = true;
				obj_3.disabled = true;
				obj_4.disabled = true;
				obj_5.disabled = true;
				obj_6.disabled = true;
			}
		}
	*#
	
	function togglePeerAssessmentOptions(checked){
		var section = document.getElementById("peerAssessmentOptions");
		if(checked){
			section.style.display="block";
			resizeFrame('grow');
		}else{
			section.style.display="none";
			resizeFrame('shrink');
		}
	}
	
	function toggleReviewServiceOptions(checked){
		var section = document.getElementById("reviewServiceOptions");
		if(checked){
			section.style.display="block";
			resizeFrame('grow');
		}else{
			section.style.display="none";
			resizeFrame('shrink');
		}
	}
	
	function toggleSmallMatchesOptions(checked){
		var section = document.getElementById("smallMatchesOptions");
		if(checked){
			section.style.display="inline-block";
		}else{
			section.style.display="none";
		}
	}
	
	function toggleSmallMatchesDisabled(){
		var radioOption1 = document.getElementById("wordCount");
		var radioOption2 = document.getElementById("percentage")
		var excludeWords = document.getElementById("tiiExcludeValueWords");
		var excludePercentages = document.getElementById("tiiExcludeValuePercentages");
		
		excludeWords.disabled = true;
		excludeWords.value = "";
		excludePercentages.disabled = true;
		excludePercentages.value = "";
		if(radioOption1.checked){
			excludeWords.disabled = false;
		}else if(radioOption2.checked){
			excludePercentages.disabled = false;
		}
	}

	## handles the Student Submissions dropdown
	function switchAssignmentSubmissionType()
	{
		var useReview = document.getElementById('$name_UseReviewService');
		var lblUseReview=document.getElementById('lblReviewService');
		var reviewSwitchNe1 = document.getElementById('review.switch.ne.1');
		var reviewSwitchNe2 = document.getElementById('review.switch.ne.2');
		if(document.getElementById('subType').value != 4)
		{
			#if ($allowReviewService)
				reviewSwitchNe1.style.display='none';
				lblReviewService.className='';
				reviewSwitchNe2.style.display='none';
				useReview.disabled=false;
			#end
			## SAK-26640
			document.getElementById('tempAllowRes').style.display = 'block';
			if (document.getElementById('allowResToggle').checked)
			{
				document.getElementById('allowResubmitNumber').style.display = 'block';
				document.getElementById('allowResubmitTime').style.display = 'block';
				document.getElementById('resubmitNotification').style.display = 'block';
				resizeFrame();
			}
		}
		else
		{ 
			#if ($allowReviewService)
				if (useReview.checked)
				{
					reviewSwitchNe2.style.removeProperty('display');
					toggleReviewServiceOptions(this.checked);
				}
				useReview.checked=false;
				useReview.disabled=true;
				lblUseReview.className='instruction';
				reviewSwitchNe1.style.removeProperty('display');
			#end
			## SAK-26640
			document.getElementById('tempAllowRes').style.display = 'none';
			document.getElementById('allowResubmitNumber').style.display = 'none';
			document.getElementById('allowResubmitTime').style.display = 'none'; 
			document.getElementById('resubmitNotification').style.display = 'none';
		}
	}

	function toggleIsGroupSubmission(checked){
		if (checked) {
			$("#site").prop("disabled", true);
			$("#groups").prop("checked", true).trigger("click");
		} else {
			$("#site").prop("disabled", false);
		}
	}
	
	function toggleAutoAnnounceOptions(checked){
		var section = document.getElementById("selectAutoAnnounceOptions");
		if(checked){
			section.style.display="block";
			resizeFrame('grow');
		}else{
			section.style.display="none";
			resizeFrame('shrink');
		}
	}
</script>
<script type="text/javascript">
	focus_path = [ '$fField' ];
</script>
<div class="portletBody">
	<ul class="navIntraTool actionToolBar">
		#if ($allowAddAssignment)
			<li class="firstToolBarItem">
				<span class="current">$!tlang.getString("new")</span>
			</li>
			<li>
				<span><a href="#" title = "$!tlang.getString('lisofass1')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='view';document.getElementById('view').value='lisofass1';document.newAssignmentForm.submit();return false;">$!tlang.getString("lisofass1")</a></span>
			</li>	
			#if ($withGrade && $!allowGradeSubmission)
				<li>
					<span><a href="#" title="$!tlang.getString('gen.grarep')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='view';document.getElementById('view').value='grarep';document.newAssignmentForm.submit();return false;">$!tlang.getString("gen.grarep")</a></span>
				</li>
			#end
				<li>
					<span><a href="#" title="$!tlang.getString('gen.stuvie')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='view';document.getElementById('view').value='stuvie';document.newAssignmentForm.submit();return false;">$!tlang.getString("gen.stuvie")</a></span>
				</li>				
		#end
		#if (($allowAllGroups) && ($assignmentscheck))
			<li>		
				<span><a href="#" title="$tlang.getString('gen.reorder')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='reorderNavigation';document.newAssignmentForm.submit();return false;">$tlang.getString('gen.reorder')</a></span>
			</li>
		#end
		#if ($allowUpdateSite)
			<li>
				<span><a href="#" title="$tlang.getString('permis')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='permissions';document.newAssignmentForm.submit();return false;">$tlang.getString('permis')</a></span>
			</li>	
		#end
	</ul>
	<h3>
		#if($validator.escapeHtml($!value_title) && $validator.escapeHtml($!value_title) !='')
			$validator.escapeHtml($!value_title) <span class="highlight">	$tlang.getString("edit")</span>
		#else
			$tlang.getString("new.title")
		#end
	</h3>

	<p class="instruction">
		$tlang.getString("newassig.comfor")			
	</p>
	#if ($alertMessage)
		<div class="alertMessage" style="width:80%  !important">
			$tlang.getString("gen.alert") 		$alertMessage
		</div>
		<div style="display:block;clear:both">
		</div>
	#end

	#set($submitnotif="submitnotifTop")
	#buttonBar($submitnotif)

	<form name = "newAssignmentForm" action="#toolForm("AssignmentAction")" method="post" onsubmit="return true;">
		<input type="hidden" name="assignmentId" value="$!assignment.Reference" />
		<input type="hidden" name="assignmentContentId" value="$!assignment.ContentReference" />
		<input type="hidden" name="eventSubmit_doAssignment_form" value="" />
		<input type="hidden" name="option" id="option" value="" />
		<input type="hidden" name="view" id="view" value="" />
		<input type="hidden" name="$name_order" id="$name_order" value="$!value_position_order" />
		<h4>$tlang.getString("gen.assig")</h4>
		<p class="shorttext">
			<span class="reqStar">*</span>
			<label for="$name_title">
				$tlang.getString("gen.title")
			</label>	
			<input name="$name_title" id="$name_title" type="text" value="$validator.escapeHtml($!value_title)" size="30" maxlength="100" />
		</p>
			#* placeholder for sections 
				<p class="shorttext">
					<label for="sectSelect">
						$tlang.getString("gen.sect")
					</label>
					<select id="sectSelect" name="$name_Section" multiple="multiple" size="3">
						#foreach ($i in ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "all"])
							#if ($value_Sections.indexOf($i)!=-1)
								<option value="$i" selected ="selected">$i</option>
							#else
								<option value="$i">$i</option>
							#end
						#end
					</select>
					<span class="instruction">
						$tlang.getString("newassig.tosel")
					</span>
				</p>	
			*#
		<script type="text/javascript" src="/library/js/lang-datepicker/lang-datepicker.js"></script>
                #if ($visible_date_enabled) 
               <p class="shorttext">
                <p class="checkbox" id="tempVisibleDate" >
                    <input type="checkbox" id="allowVisibleDateToggle" name="allowVisibleDateToggle" #if($!new_assignment_visibletoggle)checked="checked"#end onclick="if(checked){jQuery('.visibleDatePanel').show();resizeFrame();}else{jQuery('.visibleDatePanel').hide();}" />
                    <label for="allowVisibleDateToggle">$tlang.getString("allowVisibleDate")</label>
                </p>
               <p class="shorttext visibleDatePanel" #if(!$!new_assignment_visibletoggle)style="display:none;"#end>
			<span class="reqStar">*</span>
			<label>
				$tlang.getString("gen.visible.date")
			</label>
			<input type="text" id="visibledate" name="visibledate" class="datepicker" value="">
	
			<script type="text/javascript">
				localDatePicker({
					input:'#visibledate', 
					useTime:1, 
					val:"$value_VisibleYear$H$value_VisibleMonth$H$value_VisibleDay $value_VisibleHour:$value_VisibleMin",
					parseFormat: 'YYYY-MM-DD HH:mm',
					ashidden:{
						month:"new_assignment_visiblemonth",
						day:"new_assignment_visibleday",
						year:"new_assignment_visibleyear",
						hour:"new_assignment_visiblehour",
						minute:"new_assignment_visiblemin"
					}
				});
			</script>
                    </p>
               <p class="instruction labelindnt visibleDatePanel" #if(!$!new_assignment_visibletoggle)style="display:none;"#end>
			$tlang.getString("gen.stuwonsee")
		</p>
		#end
		<p class="shorttext">
			<span class="reqStar">*</span>
			<label>
				$tlang.getString("newassig.opedat")
			</label>	
			<input type="text" id="opendate" name="opendate" class="datepicker" value="">

			<script type="text/javascript">
			      localDatePicker({
			      	input:'#opendate', 
			      	useTime:1, 
			      	val:"$value_OpenYear$H$value_OpenMonth$H$value_OpenDay $value_OpenHour:$value_OpenMin",
			      	parseFormat: 'YYYY-MM-DD HH:mm',
			      	ashidden:{
			      		month:"new_assignment_openmonth",
			      		day:"new_assignment_openday",
			      		year:"new_assignment_openyear",
			      		hour:"new_assignment_openhour",
			      		minute:"new_assignment_openmin"
			      	}
			      });
			</script>

		</p>	
		<p class="instruction labelindnt">
                        $tlang.getString("gen.stucantdo")
		</p>
		<p class="shorttext">
			<span class="reqStar">*</span>
			<label>
				$tlang.getString("gen.duedat")
			</label>

			<input type="text" id="duedate" name="duedate" class="datepicker" value="">

			<script type="text/javascript">
			      localDatePicker({
			      	input:'#duedate', 
			      	useTime:1, 
			      	val:"$value_DueYear$H$value_DueMonth$H$value_DueDay $value_DueHour:$value_DueMin",
			      	parseFormat: 'YYYY-MM-DD HH:mm',
			      	ashidden:{
			      		month:"new_assignment_duemonth",
			      		day:"new_assignment_dueday",
			      		year:"new_assignment_dueyear",
			      		hour:"new_assignment_duehour",
			      		minute:"new_assignment_duemin"
			      	}
			      });
			</script>

 		</p>
		<p class="shorttext">
			<span class="reqStar">*</span>
			<label>
				$tlang.getString("gen.acesubunt")
			</label>
			#if ($value_EnableCloseDate)

			<input type="text" id="closedate" name="closedate" class="datepicker" value="">

			<script type="text/javascript">
			      localDatePicker({
			      	input:'#closedate', 
			      	useTime:1, 
			      	val:"$value_CloseYear$H$value_CloseMonth$H$value_CloseDay $value_CloseHour:$value_CloseMin",
			      	parseFormat: 'YYYY-MM-DD HH:mm',
			      	ashidden:{
			      		month:"new_assignment_closemonth",
			      		day:"new_assignment_closeday",
			      		year:"new_assignment_closeyear",
			      		hour:"new_assignment_closehour",
			      		minute:"new_assignment_closemin"
			      	}
			      });
			</script>

 			#else
				<select name="$name_CloseMonth" id="$name_CloseMonth" title="$tlang.getString("dateselectionwidget.month")" disabled="disabled">
					#foreach ($i in [1..12])
						#if ($i == $value_CloseMonth)
							<option value="$i" selected="selected">$monthTable.get($i)</option>
						#else
							<option value="$i">$monthTable.get($i)</option>
						#end
					#end
				</select>
                <label class="skip" for="$name_CloseDay">$tlang.getString("dateselectionwidget.day")</label>
				<select name="$name_CloseDay" id="$name_CloseDay" title="$tlang.getString("dateselectionwidget.day")" disabled="disabled">
					#foreach ($i in [1..31])
						#if ($i == $value_CloseDay)
							<option value="$i" selected="selected">$i</option>
						#else
							<option value="$i">$i</option>
						#end
					#end
				</select>
                <label class="skip" for="$name_CloseYear">$tlang.getString("dateselectionwidget.year")</label>
				<select name="$name_CloseYear" id="$name_CloseYear" title="$tlang.getString("dateselectionwidget.year")" disabled="disabled">
					#foreach ($i in [$!value_year_from..$!value_year_to])
						#if ($i == $value_CloseYear)
							<option value="$i" selected="selected">$i</option>
						#else
							<option value="$i">$i</option>
						#end
					#end
				</select>
				&nbsp;$tlang.getString("gen.at")&nbsp;
                <label class="skip" for="$name_CloseHour">$tlang.getString("dateselectionwidget.hour")</label>
				<select name="$name_CloseHour" id="$name_CloseHour" title="$tlang.getString("dateselectionwidget.hour")" disabled="disabled">
					#foreach ($i in [1..12])
						#if ($i == $value_CloseHour)
							<option value="$i" selected="selected">$i</option>
						#else
							<option value="$i">$i</option>
						#end
					#end
				</select>
                <label class="skip" for="$name_CloseMin">$tlang.getString("dateselectionwidget.minute")</label>
				<select name="$name_CloseMin" id="$name_CloseMin" title="$tlang.getString("dateselectionwidget.minute")" disabled="disabled">
					#foreach ($i in [00, 05, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55])
						<option value="$i" #if($i == $value_CloseMin)selected="selected"#end>#if($i ==0)00#elseif($i == 5)05#else$i#end</option>
					#end
				</select>
                <label class="skip" for="$name_CloseAMPM">$tlang.getString("dateselectionwidget.ampm")</label>
				<select name="$name_CloseAMPM" id="$name_CloseAMPM" title="$tlang.getString("dateselectionwidget.ampm")" disabled="disabled">
					#foreach ($i in ["AM", "PM"])
						#if ($i == $value_CloseAMPM)
							<option value="$i" selected="selected">$i</option>
						#else
							<option value="$i">$i</option>
						#end
					#end
				</select>
			#end
		</p>	
		<p class="instruction labelindnt">
			$tlang.getString("gen.noasscan")
		</p>
		<p class="shorttext">
			<span class="reqStar">*</span>
			<label for="subType">
				$tlang.getString("gen.stusub")
			</label>
			<select name="$name_SubmissionType" id="subType" onchange="switchAssignmentSubmissionType();" >
				#foreach ($i in [1..$!value_totalSubmissionTypes])
					#if ($i == $value_SubmissionType)
						<option value="$i" selected="selected">$submissionTypeTable.get($i)</option>
					#else
						<option value="$i">$submissionTypeTable.get($i)</option>
					#end
				#end
			</select>
			<div id="review.switch.ne.2" class="information" style="display:none;">$reviewSwitchNe2</div>
		</p>
		##show it only for those assignments not of type non-electronic submission
		#if($!value_allowResubmitNumber && $value_SubmissionType != 4)
			#set($resubmitStyle="display:block")
		#else 
			#set($resubmitStyle="display:none")
		#end
		<p class="checkbox" id="tempAllowRes" #if ($value_SubmissionType == 4) style = "display:none"#end>
			<input type="checkbox" id="allowResToggle" name ="allowResToggle" #if($!value_allowResubmitNumber) checked="checked"#end onclick="if(checked){document.getElementById('allowResubmitNumber').style.display = 'block';document.getElementById('allowResubmitTime').style.display = 'block';document.getElementById('resubmitNotification').style.display = 'block';resizeFrame();}else{document.getElementById('allowResubmitNumber').style.display = 'none';document.getElementById('allowResubmitTime').style.display = 'none';document.getElementById('resubmitNotification').style.display = 'none';}" /> 
			<label for="allowResToggle">$tlang.getString("allowResubmit")</label>
	    </p>
		<p class="shorttext" id="allowResubmitNumber" style="$!resubmitStyle">
				<label for="allowResubmitNumber">
					$tlang.getString("allow.resubmit.number")
				</label>
				<select name="$name_allowResubmitNumber" id="allowResubmitNumber" title="$tlang.getString("allow.resubmit.number")">
					#foreach ($i in [1..10])
						<option value="$i" #if($i==$!value_allowResubmitNumber)selected="selected"#end>
							$i
						</option>
					#end
					<option value="-1" #if($!value_allowResubmitNumber == -1)selected="selected"#end>$tlang.getString("allow.resubmit.number.unlimited")</option>
				</select>
		</p>
		<p class="shorttext" id="allowResubmitTime" style="$!resubmitStyle">

			<label for="$name_ResubmitMonth">
				$tlang.getString("gen.resubmission") $tlang.getString("gen.acesubunt")
			</label>
		
			<input type="text" id="resubmit" name="resubmit" class="datepicker" value="">


			<script type="text/javascript">
			      localDatePicker({
			      	input:'#resubmit', 
			      	useTime:1, 
			      	val:"$value_ResubmitYear$H$value_ResubmitMonth$H$value_ResubmitDay $value_ResubmitHour:$value_ResubmitMin",
			      	parseFormat: 'YYYY-MM-DD HH:mm',
			      	ashidden:{
			      		month:"allow_resubmit_closeMonth",
			      		day:"allow_resubmit_closeDay",
			      		year:"allow_resubmit_closeYear",
			      		hour:"allow_resubmit_closeHour",
			      		minute:"allow_resubmit_closeMin"
			      	}
			      });
			</script>
							## only show date selection when allowed to resubmit
						</p>
		<p class="shorttext" id="resubmitNotification" style="$!resubmitStyle">
			## whether to notify student about released grade and resubmission is available
			<label for="notsendreleasereturnnotif">
				$tlang.getString("send.submission.releasereturn.email.options")
			</label>
			<input type="radio" name="$!name_assignment_releasereturn_notification" id="notsendreleasereturnnotif" value="$!value_assignment_releasereturn_notification_none" #if($!value_assignment_releasereturn_notification.equals($!value_assignment_releasereturn_notification_none))checked="checked" #end />
			$tlang.getString('send.submission.releasereturn.email.none')
			<br/>
			<input type="radio" name="$!name_assignment_releasereturn_notification" id="sendreleasereturnnotif" value="$!value_assignment_releasereturn_notification_each" #if($!value_assignment_releasereturn_notification.equals($!value_assignment_releasereturn_notification_each))checked="checked" #end />
			$tlang.getString('send.submission.releasereturn.email')
		</p>
		#if ($withGrade)
			<p class="shorttext" style="clear:both">
				<span class="reqStar">*</span>
				<label for="$name_GradeType">
					$tlang.getString("gen.grasca")
				</label>
				<span class="skip">$tlang.getString("newassig.selectmessage")</span>				
				<select id="$name_GradeType"  name="$name_GradeType" title="$tlang.getString("gen.grasca")" onchange="SetMaxPoint(this, $name_GradePoints)">
					#foreach ($i in [1..5])
						#if ($i == $value_GradeType)
							<option value="$i" selected="selected">$gradeTypeTable.get($i)</option>
						#else
							<option value="$i">$gradeTypeTable.get($i)</option>
						#end
					#end
				</select>
			</p>
			<p class="labelindnt">
				## enable the maxfield when it is points grade type
				<span class="reqStar" style="display:none" id="req-$name_GradePoints">*</span>
				#if ($value_GradeType == 3)
					<input name="$name_GradePoints" id="$name_GradePoints" value="$!value_GradePoints" type="text" size="5" maxlength="11"/>
				#else
					<input name="$name_GradePoints" id="$name_GradePoints"  value="$!value_GradePoints" type="text" size="5" maxlength="11" disabled="disabled" style="background-color:#eee;border:1px solid gray"/>
				#end
				<label for="$name_GradePoints">$tlang.getString("gen.forpoi")</label>
			</p>	
		#end
			<div class="longtext">
				<label for="new_assignment_instructions" class="block">
					<span class="reqStar">*</span> $tlang.getString("gen.assinf")
				</label>
				<table border="0" style="margin:0"><tr><td>
					<textarea name="$name_Description" id="$name_Description" cols="80" rows="30" wrap="virtual">$validator.escapeHtmlFormattedTextarea($value_Description)</textarea>
					#chef_setupformattedtextarea($name_Description)
					</td></tr></table>
			</div>
		<p class="checkbox  indnt2">
			#if ($value_CheckHideDueDate.equals("true"))
				<input id="$name_CheckHideDueDate" name="$name_CheckHideDueDate" type="checkbox" value="true" checked="checked" />
			#else
				<input id="$name_CheckHideDueDate" name="$name_CheckHideDueDate" type="checkbox" value="true" />
			#end
			<label for="$name_CheckHideDueDate">
				$tlang.getString("gen.hideduedate")
			</label>
		</p>
		#if ($!name_CheckAddDueDate)
			<p class="checkbox indnt2">
				#if ($value_CheckAddDueDate.equals("true"))
					<input id="$name_CheckAddDueDate" name="$name_CheckAddDueDate" type="checkbox" value="true" checked="checked" />
				#else
					<input id="$name_CheckAddDueDate" name="$name_CheckAddDueDate" type="checkbox" value="true" />
				#end
				<label for="$name_CheckAddDueDate">
					$tlang.getString("gen.addduedat")
				</label>
			</p>
		#end
		#if ($!name_CheckAutoAnnounce)
			<p class="checkbox  indnt2">
				#if ($value_CheckAutoAnnounce.equals("true"))
					<input id="$name_CheckAutoAnnounce" name="$name_CheckAutoAnnounce" type="checkbox" value="true" checked="checked" onclick="toggleAutoAnnounceOptions(this.checked)" />
				#else
					<input id="$name_CheckAutoAnnounce" name="$name_CheckAutoAnnounce" type="checkbox" value="true" onclick="toggleAutoAnnounceOptions(this.checked)" />
				#end
				<label for="$name_CheckAutoAnnounce">
					$tlang.getString("gen.anntheope") 
				</label>
			</p>
			#if ($!$value_CheckAutoAnnounce.equals("true"))
			<div id="selectAutoAnnounceOptions" class="indnt3">
			#else
			<div id="selectAutoAnnounceOptions" style="display:none" class="indnt3">
			#end
				<p class="checkbox  indnt2">
					<select name="$name_OpenDateNotification" id="$name_OpenDateNotification">
						<option value="$value_opendate_notification_none" #if($value_OpenDateNotification.equals($value_opendate_notification_none)) selected="selected" #end>$tlang.getString('send.notification.opendate.email.none')</option>
						<option value="$value_opendate_notification_low" #if($value_OpenDateNotification.equals($value_opendate_notification_low)) selected="selected" #end>$tlang.getString('send.notification.opendate.email.low')</option>
						<option value="$value_opendate_notification_high" #if($value_OpenDateNotification.equals($value_opendate_notification_high)) selected="selected" #end>$tlang.getString('send.notification.opendate.email.high')</option>
					</select> 
			    </p>
			</div>
		#end
		<p class="checkbox  indnt2">
			#if (!$!value_CheckAddHonorPledge.equals("1"))
				<input id="$name_CheckAddHonorPledge" name="$name_CheckAddHonorPledge" type="checkbox" value="2" checked="checked" />
			#else
				<input id="$name_CheckAddHonorPledge" name="$name_CheckAddHonorPledge" type="checkbox" value="2" />
			#end
			<label for="$name_CheckAddHonorPledge">
				$tlang.getString("gen.addhonple")
			</label>
		</p>
		#if ($allowReviewService)
			<div style="display:block">
				<h4>
				$reviewServiceTitle
				</h4>
				#if (4 == $value_SubmissionType)
					<div id="review.switch.ne.1" class="information">$reviewSwitchNe1</div>
					<div class="checkbox  indnt2">
						<input id="$name_UseReviewService" name="$name_UseReviewService" type="checkbox" value="true"  onclick="toggleReviewServiceOptions(this.checked)" disabled="disabled"/>

						<label id="lblReviewService" for="$name_UseReviewService" class="instruction">
							$reviewServiceUse
						</label>
					</div>
				#else
					<div id="review.switch.ne.1" class="information" style="display:none;">$reviewSwitchNe1</div>
					<div class="checkbox indnt2">
						#if($!value_UseReviewService.equals("true"))
							<input id="$name_UseReviewService" name="$name_UseReviewService" type="checkbox" value="true" checked="checked" onclick="toggleReviewServiceOptions(this.checked)"/>
						#else
							<input id="$name_UseReviewService" name="$name_UseReviewService" type="checkbox" value="true" onclick="toggleReviewServiceOptions(this.checked)"/>
						#end

						<label id="lblReviewService" for="$name_UseReviewService">
							$reviewServiceUse
						</label>
					</div>
				#end

				#if ($!value_UseReviewService.equals("true") && $!value_SubmissionType != 4)
					<div id="reviewServiceOptions" class="indnt3">
				#else
					<div id="reviewServiceOptions" style="display:none" class="indnt3">
				#end				
					<div class="checkbox">
						#if ($!value_AllowStudentView.equals("true"))
							<input id="$name_AllowStudentView" name="$name_AllowStudentView" type="checkbox" value="true" checked="checked" />
						#else
							<input id="$name_AllowStudentView" name="$name_AllowStudentView" type="checkbox" value="true" />
						#end
						<label for="$name_AllowStudentView">
							$tlang.getString("review.allow") 
						</label>
					</div>
					<!-- Start TII custom options -->
					#if($reviewServiceName.equals("Turnitin"))

					#if ($content_review_note)
						$content_review_note
					#end
					$tlang.getString("review.submit.papers.repository")
					<br/>
					<div class="indnt1">
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT.contains($name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_NONE))
							<input type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO" value="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_NONE" #if($value_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO.equals("$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_NONE"))checked#end/>$tlang.getString("review.submit.papers.repository.none")<br/>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT.contains($name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_STANDARD))
							<input type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO" value="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_STANDARD" #if($value_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO.equals("$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_STANDARD"))checked#end/>$tlang.getString("review.submit.papers.repository.standard")<br/>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT.contains($name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_INSITUTION))
							<input type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO" value="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_INSITUTION" #if($value_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_RADIO.equals("$name_NEW_ASSIGNMENT_REVIEW_SERVICE_SUBMIT_INSITUTION"))checked#end/>$tlang.getString("review.submit.papers.repository.institution")<br/>
						#end
					</div>
					<br/>
					$tlang.getString("review.originality.reports")
					<br/>
					<div class="indnt1">
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT.contains($name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_IMMEDIATELY))
							<input type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_RADIO" value="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_IMMEDIATELY" #if($value_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_RADIO.equals("$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_IMMEDIATELY"))checked#end/>$tlang.getString("review.originality.reports.immediately")<br/>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT.contains($name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_DUE))
							<input type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_RADIO" value="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_DUE" #if($value_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_RADIO.equals("$name_NEW_ASSIGNMENT_REVIEW_SERVICE_REPORT_DUE"))checked#end/>$tlang.getString("review.originality.reports.due")<br/>
						#end
					</div>
					<br/>
					#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC || $show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED || $show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_SMALL_MATCHES)
						$tlang.getString("review.exclude.matches.header")
						<br/>
					#end
					
					<!-- Exclude Bibliographic materials -->
					#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC)
					<div class="checkbox indnt1">
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC.equals("true"))
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_BIBLIOGRAPHIC">
								$tlang.getString("review.exclude.bibliographic") 
							</label>
					</div>
					#end
					<!-- Exclude Quoted materials -->
					#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED)
					<div class="checkbox indnt1">
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED.equals("true"))
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_QUOTED">
								$tlang.getString("review.exclude.quoted") 
							</label>
					</div>
					#end
					<!-- Exclude small matches -->
					
					#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_SMALL_MATCHES)
						<div class="checkbox indnt1">
							#if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 1 || $value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 2)
								<input type="checkbox" value="true" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_SMALL_MATCHES" checked="checked"  onclick="toggleSmallMatchesOptions(this.checked)"/>
							#else
								<input type="checkbox" value="true" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_SMALL_MATCHES" onclick="toggleSmallMatchesOptions(this.checked)"/>
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE">
								$tlang.getString("review.exclude.smallMatches") 
							</label>
							<br/>
								#if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 1 || $value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 2)
									<div id="smallMatchesOptions" class="indnt2 smallMatches" style="display:inline-block;">
								#else
									<div id="smallMatchesOptions" class="indnt2 smallMatches" style="display:none;">
								#end
								$tlang.getString("review.exclude.matches.by")<span class="reqStar">*</span>
								<br/>
								<input onchange="toggleSmallMatchesDisabled()" type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE" id="wordCount" value="1" #if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE ==  1) checked="checked" #end/>
								<label for="wordCount">
									$tlang.getString("review.exclude.matches.wordmax") 
								</label>
								<input type="text" size="3" maxlength="3" id="tiiExcludeValueWords" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_VALUE" #if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE ==  1) value="$value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_VALUE" #else disabled="disabled" #end/>
								<br/>
								
								<input onchange="toggleSmallMatchesDisabled()" type="radio" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE" id="percentage" value="2" #if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 2) checked="checked" #end/>
								<label for="percentage">
									$tlang.getString("review.exclude.matches.percentage") 
								</label>
								<input type="text" size="3" maxlength="3" id="tiiExcludeValuePercentages" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_VALUE" #if ($value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_TYPE == 2) value="$value_NEW_ASSIGNMENT_REVIEW_SERVICE_EXCLUDE_VALUE" #else disabled="disabled" #end/>
								%
								<!--end div for smallMatchesOptions -->
								</div>
						</div>
					#end
					<br/>
					$tlang.getString("review.originality.check")
					<br/>
					<div class="indnt1">
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN)
						<div class="checkbox">			
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN.equals("true"))			
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_TURNITIN">
								$tlang.getString("review.originality.check.turnitin") 
							</label>
						</div>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET)
						<div class="checkbox">		
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET.equals("true"))				
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INTERNET">
								$tlang.getString("review.originality.check.internet") 
							</label>
						</div>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB)
						<div class="checkbox">						
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB.equals("true"))
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_PUB">
								$tlang.getString("review.originality.check.pub") 
							</label>
						</div>
						#end
						#if($show_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION)
						<div class="checkbox">
							#if ($!value_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION.equals("true"))						
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION" type="checkbox" value="true" checked="checked" />
							#else
								<input id="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION" name="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION" type="checkbox" value="true" />
							#end
							<label for="$name_NEW_ASSIGNMENT_REVIEW_SERVICE_CHECK_INSTITUTION">
								$tlang.getString("review.originality.check.institution") 
							</label>
						</div>
						#end
					</div>
				<!-- End TII custom options -->
				#end
			</div>
		#end
		#if( ($!withGrade && $!withGradebook) || ($enableAnonGrading || $value_CheckAnonymousGrading.equals("true")) )
			<h4>$!tlang.getString('grading')</h4>
		#end
		#if ($!withGrade && $!withGradebook)
			## show the "Add to Gradebook" choices or not
			#if(!$!allowGroupAssignmentsInGradebook)
				#set ($addToGBDisplay="none")
			#else
				#set ($addToGBDisplay="block")
			#end
				<div style="display:$!addToGBDisplay">
				<div class="checkbox  indnt2" style="display:$!addToGBDisplay">
					## hide the assignment list from Gradebook when clicked
					<input type="radio" name="$!name_Addtogradebook" id="$!gradebookChoice_no" value="$!gradebookChoice_no" #if($!gradebookChoice.equals("$!gradebookChoice_no"))checked#end onclick="if (document.getElementById('gradebookList')) {$('#gradebookList').fadeOut('slow');$('#categoryList').fadeOut('slow');}" >
					<label for="$!gradebookChoice_no">#if(!$!noAddToGradebookChoice)$tlang.getString("grading.no")#else$tlang.getString("grading.no2")#end</label>
					<br/>
					#if (!$!noAddToGradebookChoice)
						## hide the assignment list from Gradebook when clicked
						<input type="radio" name="$!name_Addtogradebook" id="$!gradebookChoice_add" value="$!gradebookChoice_add" #if($!gradebookChoice.equals("$!gradebookChoice_add"))checked#end 
							onclick="
							if ($('#new_assignment_grade_points').prop('value'))
							{
								if (document.getElementById('categoryList')) 
								{
									## show the gradebook assignment list
									if (document.getElementById('gradebookList'))
										$('#gradebookList').fadeOut('slow'); 
									if($!value_totalCategories > 1) 
										$('#categoryList').fadeIn('slow');
								}
								else
								{
									if (document.getElementById('gradebookList'))
										$('#gradebookList').fadeOut('slow');
									if (document.getElementById('associate'))
										$('#associate').prop('checked',false);
								}
							}
							else
							{
								## show alert since gradebook integration is only allowed for point-based assignment
								$('#no').prop('checked',true);
								if (document.getElementById('categoryList'))
									$('#categoryList').fadeOut('slow');
								if (document.getElementById('gradebookList'))
									$('#gradebookList').fadeOut('slow');
								if (document.getElementById('associate'))
									$('#associate').prop('checked',false);
								if (document.getElementById('gradebookListWarnAssoc'))
								{
					       	 		$('#gradebookListWarnAssoc' ).fadeIn('slow');
					        		$('#gradebookListWarnAssoc').animate({opacity: 1.0}, 2500)
					  				$('#gradebookListWarnAssoc' ).fadeOut('slow',function () 
					  				{
										$('#new_assignment_grade_type').focus();
							      	});
							     }
							}" >
						<label for="$!gradebookChoice_add">$tlang.getString("grading.add")</label>
						<span id="gradebookListWarnAssoc" class="alertMessageInline" style="display:none;border:none">$tlang.getString("grading.associate.warn")</span>
						<br/>
					#end
					## if there exists properiate assignment entries in Gradebook
					#if (!$!gradebookAssignmentsLabel.isEmpty()) 
						## show the assignment list from Gradebook when clicked
							<input 
								type="radio" 
								name="$!name_Addtogradebook" 
								id="$!gradebookChoice_associate" 
								value="$!gradebookChoice_associate" 
								#if($!gradebookChoice.equals("$!gradebookChoice_associate"))checked#end 
								onclick="if( document.getElementById('gradebookList') )
								{
									if ($('#new_assignment_grade_points').prop('value')) 
									{
										## show the gradebook assignment list
										$('#categoryList').fadeOut('slow');
										$('#gradebookList').fadeIn('slow');
									}
									else
									{
										## show alert since gradebook integration is only allowed for point-based assignment
										$('#no').prop('checked',true);
										$('#categoryList').fadeOut('slow');
										$('#gradebookList').fadeOut('slow');
										$('#associate').prop('checked',false);
						       	 		$('#gradebookListWarn' ).fadeIn('slow');
						        		$('#gradebookListWarn').animate({opacity: 1.0}, 2500)
						  				$('#gradebookListWarn' ).fadeOut('slow',function () 
						  				{
											$('#new_assignment_grade_type').focus();
								      	});
									}	
								}" >
						<label for="$!gradebookChoice_associate">$tlang.getString("grading.associate")</label>
						<span id="gradebookListWarn" class="alertMessageInline" style="display:none;border:none">$tlang.getString("grading.associate.warn")</span>
					#end
				</div>
			</div>	
			## if there exists properiate assignment entries in Gradebook
			#if (!$!gradebookAssignmentsLabel.isEmpty()) 
				## show the "Gradebook Assignment list" choices or not
				#if($!allowGroupAssignmentsInGradebook && $!gradebookChoice.equals("$!gradebookChoice_associate"))
					#set ($gbListDisplay="block")
				#else
					#set ($gbListDisplay="none")
				#end
				<p id="gradebookList" class="checkbox  indnt4" style="display:$gbListDisplay">
					<select name="$!name_AssociateGradebookAssignment" >
						<option  value="">$tlang.getString("grading.select")</option>
						#set($gAssignmentSet = $!gradebookAssignmentsLabel.keySet())
						#foreach ($gaId in $!gAssignmentSet.iterator())
							<option  value="$gaId" 
								#if($!gradebookAssignmentsSelectedDisabled.get($gaId).equals("disabled")) 
									disabled="disabled"
								#elseif($!gradebookAssignmentsSelectedDisabled.get($gaId).equals("selected")) 
									selected="selected"
								#end>
									$validator.escapeHtml($!gradebookAssignmentsLabel.get($gaId))
							</option>
						#end
					</select>
				</p>
				
				## show the "Category list" choices or not
				<p id="categoryList" class="checkbox  indnt4" #if($!gradebookChoice.equals("$!gradebookChoice_add"))style="display:block" #else style="display:none" #end>
					<label for="category">
						$tlang.getString("grading.categorylist")
					</label>
					<select name="$name_Category" id="category">
						#foreach ($i in $categoryKeys)
							<option value="$i" #if ($i == $!value_Category)selected="selected"#end>$categoryTable.get($i)</option>
						#end
					</select>
				</p>
			#end
		#end

		## SAK-17606 - Show the anonymous grading checkbox if enabled
		#if( $enableAnonGrading || $value_CheckAnonymousGrading.equals("true") )
			#if ($withGrade && $withGradebook)
				<br />
			#end
			<p class="checkbox indnt2">
				<input id="$name_CheckAnonymousGrading" name="$name_CheckAnonymousGrading" type="checkbox" value="true" 
					#if ($value_CheckAnonymousGrading.equals("true"))
						checked="checked"
					#end
					#if( !$enableAnonGrading )
						disabled="disabled"
					#end
				/>
			<label for="$name_CheckAnonymousGrading" #if( !$enableAnonGrading ) class="disabled" #end>
				$tlang.getString("grading.anonymous") 
			</label>
			</p>
		#end
		## end anonymous check

		## Peer Assessment
		#if ($allowPeerAssessment)
			<div style="display:block">
				<h4>
				$peerAssessmentName
				</h4>
				<div class="checkbox  indnt2">
					#if ($!value_UsePeerAssessment.equals("true"))
						<input id="$name_UsePeerAssessment" name="$name_UsePeerAssessment" type="checkbox" value="true" checked="checked" onclick="togglePeerAssessmentOptions(this.checked)"/>
					#else
						<input id="$name_UsePeerAssessment" name="$name_UsePeerAssessment" type="checkbox" value="true"  onclick="togglePeerAssessmentOptions(this.checked)"/>
					#end
					<label for="$name_UsePeerAssessment">
						$peerAssessmentUse
					</label>
				</div>
				#if ($!value_UsePeerAssessment.equals("true"))
					<div id="peerAssessmentOptions" class="indnt3">
				#else
					<div id="peerAssessmentOptions" style="display:none" class="indnt3">
				#end
					<p class="instruction">
						$tlang.getString("peerassessment.note")
					</p>
					<div id="peerperiod-finish">
					$tlang.getString("peerassessment.periodfinishes")
						<input type="text" id="new_assignment_peerperiod" name="new_assignment_peerperiod" class="datepicker" value="">
					</div>

						<script type="text/javascript">
						      localDatePicker({
						      	input:'#new_assignment_peerperiod', 
						      	useTime:1, 
						      	val:"$value_PeerPeriodYear$H$value_PeerPeriodMonth$H$value_PeerPeriodDay $value_PeerPeriodHour:$value_PeerPeriodMin",
						      	parseFormat: 'YYYY-MM-DD HH:mm',
						      	ashidden:{
						      		month:"$name_PeerPeriodMonth",
						      		day:"$name_PeerPeriodDay",
						      		year:"$name_PeerPeriodYear",
						      		hour:"$name_PeerPeriodHour",
						      		minute:"$name_PeerPeriodMin"
						      	}
						      });
						</script>
					##Anonymous Eval
					#if ($!value_PeerAssessmentAnonEval.equals("true"))
						<input id="$name_PeerAssessmentAnonEval" name="$name_PeerAssessmentAnonEval" type="checkbox" value="true" checked="checked"/>
					#else
						<input id="$name_PeerAssessmentAnonEval" name="$name_PeerAssessmentAnonEval" type="checkbox" value="true"/>
					#end
					<label for="$name_PeerAssessmentAnonEval">
						$tlang.getString("peerassessment.anonymousEvaluation")
					</label>
					<br/>
					##Students View Reviews
					#if ($!value_PeerAssessmentStudentViewReviews.equals("true"))
						<input id="$name_PeerAssessmentStudentViewReviews" name="$name_PeerAssessmentStudentViewReviews" type="checkbox" value="true" checked="checked"/>
					#else
						<input id="$name_PeerAssessmentStudentViewReviews" name="$name_PeerAssessmentStudentViewReviews" type="checkbox" value="true"/>
					#end
					<label for="$name_PeerAssessmentStudentViewReviews">
						$tlang.getString("peerassessment.studentViewReviews")
					</label>
					<br/>
					##Number of Submissions for review
					<span class="reqStar">*</span>
					<input name="$name_PeerAssessmentNumReviews" id="$name_PeerAssessmentNumReviews" value="$!value_PeerAssessmentNumReviews" type="text" size="5" maxlength="11"/>
					<label for="$name_PeerAssessmentNumReviews">
						$tlang.getString("peerassessment.numSubmissions")
					</label>
					<br/>
					<br/>
					$tlang.getString("peerassessment.reviewInstructions")
					<br/>
					<table border="0" style="margin:0"><tr><td>
						<textarea name="$name_PeerAssessmentInstructions" id="$name_PeerAssessmentInstructions" cols="80" rows="30" wrap="virtual">$validator.escapeHtmlTextarea($!value_PeerAssessmentInstructions)</textarea>
						#chef_setupformattedtextarea($name_PeerAssessmentInstructions)
					</td</tr></table>
				</div>
			</div>
		#end
		
		
		## group/section support
                <h4>$!tlang.getString('access')</h4>
                #set( $class = "" )
                #if( !$!groupsList )
                    #set( $class = "disabled" )
                #end

                #if( $allowAddSiteAssignment )
                    #set( $selectedGroupsNotFound = true )
                    #foreach( $group in $!groupsList )
                        #foreach( $aGroupRef in $assignmentGroups )
                            #set( $aGroup = $!site.getGroup( $!aGroupRef ) )
                            #if( $!group.Id == $!aGroup.Id )
                                #set( $selectedGroupsNotFound = false )
                            #end
                        #end
                    #end

                    <div id="messages">
                    #if( $!range == "groups" && $selectedGroupsNotFound )
                        #if( $!groupsList.size() > 0 )
                            <div id="msgSelectedGroupsGoneOtherGroupsPresent" class="messageInformation indnt2" style="width: 80% !important;">$tlang.getString( "settings.access.selectedGroupsGoneOtherGroupsPresent" )</div>
                        #else
                            <div id="msgSelectedGroupsGoneNoGroups" class="messageInformation indnt2" style="width: 80% !important;">$tlang.getString( "settings.access.selectedGroupsGoneNoGroups" )</div>
                        #end
                    #elseif( !$!groupsList )
                        <div id="msgNoGroupsPresent" class="messageInformation indnt2" style="width: 80% !important;">$tlang.getString( "settings.access.noGroupsPresent" )</div>
                    #end
                    </div>

                                 #if ($group_submissions_enabled)
                                    <p class="checkbox  indnt2">
                            <input id="$name_CheckIsGroupSubmission" name="$name_CheckIsGroupSubmission" type="checkbox" value="1" onclick="toggleIsGroupSubmission(this.checked);"
                            #if ($!value_CheckIsGroupSubmission.equals("1") && $!groupsList)
                                checked="checked"
                                        #end
                            #if( !$!groupsList )
                                disabled="disabled"
                            #end
                            />
                            <label for="$name_CheckIsGroupSubmission" class="$class">
                                            $tlang.getString("group.issubmit")
                                        </label>
                                    </p>
                                #end
                                #if ($multipleGroupUsers)
                                                <p class="checkbox indnt2">
                                                <div style="color: red;" class="indnt2">$tlang.getString("group.user.multiple.warning")</div>
                                                <div style="color: red;" class="indnt3">
                                                #foreach($duser in $!multipleGroupUsers)
                                                        #if ($velocityCount > 1), #end
                                                        $duser
                                                #end
                                                </div>
                                                </p>
                                #end

				<p class="checkbox  indnt2">
                    #if( !$!allowGroupAssignmentsInGradebook )
                        <input type="radio" name="range" id="site" value="site" onclick="if (document.getElementById('addToGradebook') !=null){$('#addToGradebook').fadeOut('slow'); ASN.showOrHideAccessMessages( false ); resizeFrame()};$('#groupTable').fadeOut('slow'); ASN.showOrHideAccessMessages( false ); resizeFrame();" 
                        #if( $!range == "site" || $selectedGroupsNotFound )
                            checked="checked"
                        #end
                        />
					#else
                        <input type="radio" name="range" id="site" value="site" onclick="$('#groupTable').fadeOut('slow'); ASN.showOrHideAccessMessages( false ); resizeFrame();" 
                        #if( $!range == "site" || $selectedGroupsNotFound )
                            checked="checked"
                        #elseif ($!value_CheckIsGroupSubmission.equals("1") && $!groupsList)
                            disabled="disabled"
                        #end
                        />
                    #end
					<label for="site">$tlang.getString("displayto.site")</label>
                    </p>
		#elseif( $allowAddAssignment )
			#if ($!groups.size() >1)
                        <label class="$class" for="groups">$tlang.getString("groups")</label>
			#else
                        <label class="$class" for="groups">$tlang.getString("group")</label>
			#end
		#end

			## added group awareness
			<p class="checkbox indnt2">
                #if( !$!allowGroupAssignmentsInGradebook )
                    <input type="radio" name="range" id="groups" value="groups" onclick="if (document.getElementById('addToGradebook') != null){document.getElementById('addToGradebook').style.display = 'none';document.getElementById('$!name_Addtogradebook').checked=false};$('#groupTable').fadeIn('slow'); ASN.showOrHideAccessMessages( true ); resizeFrame();" 
                    #if( $!range == "groups" && !$selectedGroupsNotFound )
                        checked="checked"
                    #elseif( !$!groupsList )
                        disabled="disabled"
                    #end
                    />
				#else
                    <input type="radio" name="range" id="groups" value="groups" onclick="$('#groupTable').fadeIn('slow'); ASN.showOrHideAccessMessages( true ); resizeFrame();" 
                    #if( $!range == "groups" && !$selectedGroupsNotFound )
                        checked="checked"
                    #elseif( !$!groupsList )
                        disabled="disabled"
				#end
                    />  
                #end
                    <label class="$class" for="groups">$tlang.getString("displayto.selected")</label>
                </p>

                #set( $selectGroupsDisplay = "block" )
                #if( (($!range == "groups" || $!assignment.Access == $groupAccess) && !$selectedGroupsNotFound) || $selectedGroupsNotFound || $!range == "site" )
                    #set( $selectGroupsDisplay = "none" )
                #end
                #if( ($!range == "groups" || $!assignment.Access == $groupAccess) && !$selectedGroupsNotFound )
                    #set( $listDisplay = "block" )
			#else
                    #set( $listDisplay = "none" )
			#end
                <div id="msgSelectGroups" class="messageInformation indnt3" style="width: 80% !important; display: $selectGroupsDisplay">$tlang.getString( "settings.access.selectGroups" )</div>
			<table id="groupTable" style="width:80%;display:$listDisplay" class="listHier lines indnt3" border="0" cellpadding="0" cellspacing="0" summary="$tlang.getString('group.list.summary')">
					<tr>
						<th id ="selectAllGroups" style="width:2em;padding-left:.4em">
                            <input type="checkbox" name="selectall" id="selectall" title="$tlang.getString('gen.toggle')" onclick="toggleSelectAll(this, 'selectedGroups'); ASN.showOrHideSelectGroupsMessage();"  />
						</th>
						<th id ="groupname">
								$tlang.getString('gen.title')
						</th>
						<th id ="groupdescription">
							$tlang.getString('group.list.descr')
						</th>
					</tr>
					#foreach ($group in $!groups)
						<tr>
							<td headers="selected" style="width:2em">
								#set($selected=false)
								#foreach($aGroupRef in $assignmentGroups)
									#set($aGroup = $!site.getGroup($!aGroupRef))
									#if ($!group.Id == $!aGroup.Id)
										#set($selected = true)
									#end
								#end
                                <input type="checkbox" name="selectedGroups" id="id-$group.Id" title="$group.Id" value="$group.Id" #if($selected) checked="checked"#end onclick="ASN.showOrHideSelectGroupsMessage();" />
							</td>
							<td headers="name" class="checkbox" style="white-space:nowrap">
                                                                <label for="id-$group.Id">
									$validator.escapeHtml($group.Title)
								</label>	
							</td>
                            <td headers="description" width="100%"> ##mozilla does not resize table children dynamically , so set here
                                                                #set($description = "")
                                #set($description = $group.Description)
								$validator.escapeHtml($!description)
							</td>
						</tr>
					#end
				</table>
		## whether to show the instructor notification choices
		#if ($!name_assignment_instructor_notifications)
            <fieldset>
                <legend>
                    <h4>
                        $tlang.getString("receive.confirm.submission.email.options")
                    </h4>
                </legend>
    			<p class="checkbox  indnt2">
    				<input type="radio" name="$!name_assignment_instructor_notifications" id="notsendnotif" value="$!value_assignment_instructor_notifications_none" #if($!value_assignment_instructor_notifications.equals($!value_assignment_instructor_notifications_none))checked="checked" #end />
    				<label for="notsendnotif">$tlang.getString('receive.confirm.submission.email.none')</label>
    			</p>
                <p class="checkbox  indnt2">
    				<input type="radio" name="$!name_assignment_instructor_notifications" id="sendnotif" value="$!value_assignment_instructor_notifications_each" #if($!value_assignment_instructor_notifications.equals($!value_assignment_instructor_notifications_each))checked="checked" #end />
    				<label for="sendnotif">$tlang.getString('receive.confirm.submission.email.each')</label>
    			</p>
                <p class="checkbox  indnt2">
    				<input type="radio" name="$!name_assignment_instructor_notifications" id="sendnotifsummary" value="$!value_assignment_instructor_notifications_digest" #if($!value_assignment_instructor_notifications.equals($!value_assignment_instructor_notifications_digest))checked="checked" #end />
    				<label for="sendnotifsummary">$tlang.getString('receive.confirm.submission.email.digest')</label>
    			</p>
            </fieldset>
		#end
		## whether to notify student about released grade
		     <fieldset>
		         <legend>
		             <h4>
                        $tlang.getString("send.submission.releasegrade.email.options")
                    </h4>
                </legend>
		         <p class="checkbox  indnt2"> 
        			<input type="radio" name="$!name_assignment_releasegrade_notification" id="notsendreleasegradenotif" value="$!value_assignment_releasegrade_notification_none" #if($!value_assignment_releasegrade_notification.equals($!value_assignment_releasegrade_notification_none))checked="checked" #end />
        			<label for="notsendreleasegradenotif">$tlang.getString('send.submission.releasegrade.email.none')</label>
			     </p>
                 <p class="checkbox  indnt2">
        			<input type="radio" name="$!name_assignment_releasegrade_notification" id="sendreleasegradenotif" value="$!value_assignment_releasegrade_notification_each" #if($!value_assignment_releasegrade_notification.equals($!value_assignment_releasegrade_notification_each))checked="checked" #end />
        			<label for="sendreleasegradenotif">$tlang.getString('send.submission.releasegrade.email')</label>
                </p>
		  </fieldset>
		## attachments
		<h4>
			$tlang.getString("gen.att")
		</h4>
		#set ($size = 0)
		#set ($props = false)
		#foreach ($attachment in $attachments) 
			#set ($props = $attachment.Properties) 
			#if ($!props)
				#set ($size = $size + 1)
			#end
		#end
		#if ($size == 0)
			<p class="instruction">
                            #if ($value_SubmissionType == 5)
                                $tlang.getString("gen.noatt.single")
                            #else
                                $tlang.getString("gen.noatt")
                            #end
                        </p>

			<div class="act">
				<input type="button" name="attach" value="$tlang.getString('gen.addatt')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='attach';document.newAssignmentForm.submit();return false;"/>
			</div>
		#else
			<ul class="attachList indnt1">
				#foreach ($attachment in $attachments) 
					<input type="hidden" name="attachments" id="attachments" value="$attachment.Reference" />
					#set ($props = false)
					#set ($props = $attachment.Properties) 
					#if ($!props)
						<li>
							#if ($props.getBooleanProperty($props.NamePropIsCollection))
								<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
							#else
								<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
							#end
							<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
							#propertyDetails($props)
						</li>
					#end
				#end
			</ul>
			<div class="act">
				<input type="button" name="attach" value="$tlang.getString('gen.adddroatt')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='attach';document.newAssignmentForm.submit();return false;" />
			</div>
		#end	
		<a name="extraNodesTop"></a>
		<h3 style="margin-bottom:0">$tlang.getString("additional_information")</h3>
		<table class="listHier lines nolines" style="width:auto;" id="extraNodeLinkList">
			<caption style="border-bottom:1px solid #ccc;text-align:left; margin-top:1em;padding-bottom:.3em">$tlang.getString("supplement")</caption>
			<tr>
				<td style="padding-right:5em">
					$tlang.getString("modelAnswer")
				</td>
				<td class="itemAction" style="white-space:nowrap">
					<div id="nomodelanswer"  #if(!$!modelanswer) style="display:block"#else style="display:none" #end>
						<a id="modelanswer_add" class="extraNodeLink" href="#">$tlang.getString("new")<span class="skip"> $tlang.getString("modelAnswer")</span></a>
					</div>
					<div id="hasmodelanswer"  #if($!modelanswer) style="display:block"#else style="display:none" #end>
						<a id="modelanswer_edit" class="extraNodeLink" href="#">$tlang.getString("gen.revi")<span class="skip"> $tlang.getString("modelAnswer")</span></a> | <a id="modelanswer_delete" class="extraNodeLink" href="#">$tlang.getString("delet")<span class="skip"> $tlang.getString("modelAnswer")</span></a>
						<input id = "modelanswer_to_delete" name = "modelanswer_to_delete" type= "hidden" value = "false" />
					</div>
				</td>
			</tr>
			## show the private note section if only the user can view or edit the item
			#if ($!allowEditAssignmentNoteItem || $!allowReadAssignmentNoteItem)
				<tr>
					<td style="padding-right:5em">
						$tlang.getString("note")
					</td>
					<td class="itemAction" style="white-space:nowrap">
						<div id="nonote"  #if(!$!note) style="display:block"#else style="display:none" #end> 
							<a id="note_add" class="extraNodeLink" href="#">$tlang.getString("new")<span class="skip"> $tlang.getString("note")</span></a>
						</div>
						<div id="hasnote"  #if($!note) style="display:block"#else style="display:none" #end>
							#if ($!allowEditAssignmentNoteItem)
								<a id="note_edit" class="extraNodeLink" href="#">$tlang.getString("gen.revi")<span class="skip"> $tlang.getString("note")</span></a> | <a id="note_delete" class="extraNodeLink" href="#">$tlang.getString("delet")<span class="skip"> $tlang.getString("note")</span></a>
							#else
								#if ($!allowReadAssignmentNoteItem)
									<a id="note_edit" class="extraNodeLink" href="#">$tlang.getString("gen.view2")</a>
								#end
							#end
						</div>
						<input id = "note_to_delete" name = "note_to_delete" type= "hidden" value = "false" />
					</td>
				</tr>
			#end
			<tr>
				<td style="padding-right:5em">
					$tlang.getString("allPurpose")
				</td>
				<td class="itemAction" style="white-space:nowrap">
					<div id="noallPurpose" #if(!$!allPurpose) style="display:block"#else style="display:none" #end>
						<a id="allPurpose_add" class="extraNodeLink" href="#">$tlang.getString("new")<span class="skip"> $tlang.getString("allPurpose")</span></a>
					</div>
					<div id="hasallPurpose" #if($!allPurpose) style="display:block"#else style="display:none" #end>
						<a id="allPurpose_edit" class="extraNodeLink" href="#">$tlang.getString("gen.revi")<span class="skip"> $tlang.getString("allPurpose")</span></a> | <a id="allPurpose_delete" class="extraNodeLink" href="#">$tlang.getString("delet")<span class="skip"> $tlang.getString("allPurpose")</span></a>
					</div>
					<input type="hidden" name="value_allPurpose" #if($!allPurpose) value="true" #else value="false" #end />
					<input id = "allPurpose_to_delete" name = "allPurpose_to_delete" type= "hidden" value = "false" />
					#*
						<div id="noAllPurpose" #if(!$!allPurpose) style="display:block"#else style="display:none" #end>
							<a id="allPurpose_add" class="extraNodeLink" href="#">$tlang.getString("new")</a>
						</div>
						<div id="hasAllPurpose" #if($!allPurpose) style="display:block"#else style="display:none" #end>
							<a id="allPurpose_edit" class="extraNodeLink" href="#">$tlang.getString("gen.revi")</a> | <a id="allPurpose_delete" class="extraNodeLink" href="#">$tlang.getString("delet")</a>
						</div>
					*#
				</td>
			</tr>
		</table>
		##</div>		
		
		#*<p class="shorttext">
				<label for="selectExtra">
					Add item
				</label>
				<select id="selectExtra">
						<option value="1default"> --select one-- </option>
						<option value="modelanswer">Model Answer</option>
						<option value="gradingguidelines">Grading guidelines</option>
						<option value="assignotes">Private notes</option>
						<option value="otherextranodes">All purpose item</option>
				</select>
			</p>
		*#
		<a name="extraNodesBoxTop"></a>		
		<input type="hidden" name = "attachments_for" id="attachments_for" value="$!attachments_for" />
		<fieldset class="extraNode" id="modelanswer-node" style="display:none">## the panel for model answer
			<legend>$tlang.getString("modelAnswer")</legend>
			<div class="longtext" style="margin:.2em">
				<label for="modelanswer_text" class="block">
					<span class="reqStar">*</span>$tlang.getString("modelAnswer.instruction")
				</label>
				<div class="validationError alertMessage" id="modelanswer_text_message">
					$tlang.getString("extraNodesRequired")
				</div>	
				<textarea name="modelanswer_text" id="modelanswer_text" cols="60" rows="10" wrap="virtual">$validator.escapeHtmlTextarea($!modelanswer_text)</textarea>
				<textarea name="modelanswer_text_holder" id="modelanswer_text_holder" style="display:none" cols="60" rows="2" wrap="virtual">$validator.escapeHtmlTextarea($!modelanswer_text)</textarea>
				###chef_setupformattedtextareaparams("modeltext" "200" "365" "small") 
			</div>
			## attachments
			<label for="modelAnswerAttach" class="block">
					$tlang.getString("gen.att")
			</label>
			#set ($size = 0)
			#set ($props = false)
			#foreach ($attachment in $modelanswer_attachments) 
				#set ($props = $attachment.Properties) 
				#if ($!props)
					#set ($size = $size + 1)
				#end
			#end
			#if ($size == 0)
				<p class="instruction">
                                    #if ($value_SubmissionType == 5)
                                        $tlang.getString("gen.noatt.single")
                                    #else
                                        $tlang.getString("gen.noatt")
                                    #end
                                </p>
			#else
				<ul class="attachList indnt1">
					#foreach ($attachment in $modelanswer_attachments) 
						#set ($props = false)
						#set ($props = $attachment.Properties) 
						#if ($!props)
							<li>
								#if ($props.getBooleanProperty($props.NamePropIsCollection))
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
								#else
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
								#end
								<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
								#propertyDetails($props)
							</li>
						#end
					#end
				</ul>
			#end
			<div class="act">
				<input type="button" name="modelAnswerAttach" value="$tlang.getString('gen.addatt')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='modelAnswerAttach';document.newAssignmentForm.submit();return false;"/>
			</div>

			<p class="longtext"  style="margin:.2em">
				<span class="reqStar">*</span>
				<label for="modelanswer_to" class="block">
					$tlang.getString("modelAnswer.show_to_student.prompt")
				</label>
				## show to student time option
				<select id="modelanswer_to" name="modelanswer_showto" title="$tlang.getString("modelAnswer.show_to_student.tooltip")">
					#foreach ($k in ["0", "1", "2", "3", "4"])
						#set($string = "modelAnswer.show_to_student.")
						#set($string = $string.concat($k))
						<option value="$k" #if($k.equals($!modelanswer_showto))selected="selected" #set( $modelanswer_to_val = $k) #end> $tlang.getString($string) </option>
					#end
				</select>
				<span class="validationError alertMessageInline" id="modelanswer_to_message">
					$tlang.getString("extraNodesRequired")
				</span>	

				<input type="text" id="modelanswer_to_holder"  style="display:none"  value="$modelanswer_to_val" />
			</p>
			<p class="act">
				<input class="extraNodeInput" type="button" id="modelanswer_save" value="$tlang.getString('gen.sav')" class="active" />
				<input class="extraNodeInput" type="button" id="modelanswer_cancel" value="$tlang.getString('gen.can')" />
			</p>
		</fieldset>
		#*the panel for grading guideline
			<fieldset class="extraNode" id="gradingguidelines-node" style="display:none">
				<legend>Grading guidelines</legend>
					<div class="validationError alertMessage" id="gradingguidelines-message">
					</div>
				<div class="longtext" style="margin:.2em">
					<span class="reqStar">*</span>
					<label for="ggtext" class="block">
						Provide grading rationale. You can choose to whom and when this will display.
					</label>
						<textarea name="ggtext" id="ggtext" cols="60" rows="10" wrap="virtual"></textarea>
						###chef_setupformattedtextareaparams("ggtext" "200" "365" "small")					
				</div>
				<div class="act">
						<input type="button" name="attach" value="$tlang.getString('gen.addatt')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='attach';document.newAssignmentForm.submit();return false;"/>
					</div>
				<p class="longtext"  style="margin:.2em">
					<span class="reqStar">*</span>
					<label for="ggwho" class="block">
						Show
					</label>
					<select id="ggwho">
						<option value="ggwhodefault"> --select one-- </option>
						<option value="ggwho1">Only to instructors</option>
						<option value="ggwho2">also to students (after grading)</option>
						<option value="ggwho3">also to students (after accept until date)</option>
					</select>
				</p>
				<p class="act">
					<input class="extraNodeInput"  type="button" value="Save" class="active"/><input class="extraNodeInput"  type="button" value="Cancel" />
				</p>
			</fieldset>	
		*#
		<fieldset class="extraNode" id="note-node" style="display:none">## the panel for private note
			<legend>$tlang.getString("note")</legend>
			<div class="longtext" style="margin:.2em">
				<span class="reqStar">*</span>				
				<label for="note_text" class="block">
					$tlang.getString("note.instruction") 
				</label>
				<div class="validationError alertMessage" id="note_text_message">
					$tlang.getString("extraNodesRequired")
				</div>	
				#if ($!note && $!allowEditAssignmentNoteItem || !$!note)
					<textarea name="note_text" id="note_text" cols="60" rows="10" wrap="virtual">$validator.escapeHtmlTextarea($!note_text)</textarea>
					<textarea name="note_text_holder" id="note_text_holder"  style="display:none"  cols="60" rows="2" wrap="virtual">$validator.escapeHtmlTextarea($!note_text)</textarea>
				#else
					#if ($!allowReadAssignmentNoteItem)
					 <div class="notes">$validator.escapeHtml($!note_text)</div>
				 #end
				#end
				###chef_setupformattedtextareaparams("assigntext" "200" "365" "small")
			</div>
			<p class="longtext"  style="margin:.2em">
				<span class="reqStar">*</span>				
				<label for="note_to" class="block">
					$tlang.getString("note.to.prompt")
				</label>
				#if ($!note && $!allowEditAssignmentNoteItem || !$!note)
					<select id="note_to" name="note_to" title="$tlang.getString("note.to.tooltip")">
						#foreach ($k in ["0", "1", "2", "3"])
							#set($string = "note.to.")
							#set($string = $string.concat($k))
							<option value="$k" #if($k.equals($!note_to)) selected="selected" #set ($note_to_val=$k) #end> $tlang.getString($string) </option>
						#end
					</select>
				#else
					#if ($!allowReadAssignmentNoteItem)
						#foreach ($k in ["0", "1", "2", "3"])
							#set($string = "note.to.")
							#set($string = $string.concat($k))
							#if($k.equals($!note_to))
								$tlang.getString($string)
							#end
						#end
					#end
				#end
				<span class="validationError alertMessageInline" id="note_to_message">
					$tlang.getString("extraNodesRequired")
				</span>	
				<input type="text" id="note_to_holder"  style="display:none"  value="$note_to_val" />
			</p>
			#if ($!note && $!allowEditAssignmentNoteItem || !$!note)
				<p class="act">
					## can only edit if there is no note item, or if there is a note item and the current user can edit it.
					<input class="extraNodeInput" type="button" id="note_save" value="$tlang.getString('gen.sav')" class="active" />
					<input class="extraNodeInput" type="button" id="note_cancel" value="$tlang.getString('gen.can')" />
				</p>
			#end
		</fieldset>			
		<fieldset class="extraNode" id="allPurpose-node" style="display:none">## the panel for allPurpose type of object
			<legend>$tlang.getString('allPurpose')</legend>
			<div class="shorttext" style="margin:.2em">
				<span class="reqStar">*</span>				
				<label  for="allPurpose_title">$validator.escapeHtml($tlang.getString("gen.title"))</label>
				<input id="allPurpose_title" name="allPurposeTitle" type="text" size="20" maxlength="30" value="$!value_allPurposeTitle" />
				<input id="allPurpose_title_holder"  style="display:none"  name="allPurposeTitle" type="text" size="2" maxlength="30" value="$!value_allPurposeTitle" />
				<span class="validationError alertMessageInline" id="allPurpose_title_message">
					$tlang.getString("extraNodesRequired")
				</span>	
			</div>	

			<div class="longtext" style="margin:.2em">
				<span class="reqStar">*</span>
				<label for="allPurpose_text" class="block">
					$tlang.getString("allPurpose.instruction")
				</label>
				<div class="validationError alertMessage" id="allPurpose_text_message">
					$tlang.getString("extraNodesRequired")
				</div>	
				<textarea name="allPurposeText" id="allPurpose_text" cols="60" rows="10" wrap="virtual">$validator.escapeHtmlTextarea($!value_allPurposeText)</textarea>
				<textarea name="allPurposeTextHolder"  id="allPurpose_text_holder"  style="display:none"  cols="60" rows="2" wrap="virtual">$validator.escapeHtmlTextarea($!value_allPurposeText)</textarea>
			</div>	
			## attachments for allpurpose item
			<label for="allPurposeAttach" class="block">
					$tlang.getString("gen.att")
			</label>
			#set ($size = 0)
			#set ($props = false)
			#foreach ($attachment in $allPurpose_attachments) 
				#set ($props = $attachment.Properties) 
				#if ($!props)
					#set ($size = $size + 1)
				#end
			#end
			#if ($size == 0)
				<p class="instruction">
                                    #if ($value_SubmissionType == 5)
                                        $tlang.getString("gen.noatt.single")
                                    #else
                                        $tlang.getString("gen.noatt")
                                    #end
                                </p>
			#else
				<ul class="attachList indnt1">
					#foreach ($attachment in $allPurpose_attachments) 
						#set ($props = false)
						#set ($props = $attachment.Properties) 
						#if ($!props)
							<li>
								#if ($props.getBooleanProperty($props.NamePropIsCollection))
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
								#else
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
								#end
								<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
								#propertyDetails($props)
							</li>
						#end
					#end
				</ul>
			#end
			<div class="act">
				<input type="button" name="allPurposeAttach" id="allPurposeAttach" value="$tlang.getString('gen.addatt')" onclick="javascript:document.newAssignmentForm.onsubmit();document.getElementById('option').value='allPurposeAttach';document.newAssignmentForm.submit();return false;"/>
			</div>
			<div class="validationError alertMessage" id="allPurpose_release_after_retract_message">
				$tlang.getString("allPurpose.alert.release.afer.retract")
			</div>
			<table id="allPurposeAttachShowWhen">
				<tr>
					<td>
						<input name="allPurposeHide" id="allPurposeHide1" value="false" #if(!$!value_allPurposeHide)checked="checked"#end type="radio" />
					</td>
					<td colspan="4">
						<label for="allPurposeHide1">
							$tlang.getString("allPurpose.show")
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
						<input name="allPurposeShowFrom" id="allPurposeShowFrom" value="true" type="checkbox" #if ($value_allPurposeShowFrom) checked="checked" #end />
					</td>
					<td colspan="3">
						<label for="allPurposeShowFrom">
							$tlang.getString("allPurpose.show.from")
						</label>	
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						<label for="allPurposeReleaseYear">
							$tlang.getString("allPurpose.show.date")
						</label>
					</td>
					<td>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>

						<input type="text" id="allPurposeRelease" name="allPurposeRelease" class="datepicker" value="">

						<script type="text/javascript">
						      localDatePicker({
						      	input:'#allPurposeRelease', 
						      	useTime:1, 
						      	val:"$value_allPurposeReleaseYear$H$value_allPurposeReleaseMonth$H$value_allPurposeReleaseDay $value_allPurposeReleaseHour:$value_allPurposeReleaseMin",
						      	parseFormat: 'YYYY-MM-DD HH:mm',
						      	ashidden:{
						      		month:"allPurpose_releaseMonth",
						      		day:"allPurpose_releaseDay",
						      		year:"allPurpose_releaseYear",
						      		hour:"allPurpose_releaseHour",
						      		minute:"allPurpose_releaseMin"
						      	}
						      });
						</script>

					</td>
					<td>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
						<input name="allPurposeShowTo" id="allPurposeShowTo" value="true" type="checkbox" #if ($!value_allPurposeShowTo) checked="checked" #end />
					</td>
					<td colspan="4">
						<label for="allPurposeShowTo">
							$tlang.getString("allPurpose.show.util")
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						<label for="allPurposeRetractYear">
							$tlang.getString("allPurpose.show.date")
						</label>
					</td>
					<td>
						<label for="allPurposeRetractHour">
							$tlang.getString("allPurpose.show.time")
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>

						<input type="text" id="allPurposeRetract" name="allPurposeRetract" class="datepicker" value="">

						<script type="text/javascript">
						      localDatePicker({
						      	input:'#allPurposeRetract', 
						      	useTime:1, 
						      	val:"$value_allPurposeRetractYear$H$value_allPurposeRetractMonth$H$value_allPurposeRetractDay $value_allPurposeRetractHour:$value_allPurposeRetractMin",
						      	parseFormat: 'YYYY-MM-DD HH:mm',
						      	ashidden:{
						      		month:"allPurpose_retractMonth",
						      		day:"allPurpose_retractDay",
						      		year:"allPurpose_retractYear",
						      		hour:"allPurpose_retractHour",
						      		minute:"allPurpose_retractMin"
						      	}
						      });
						</script>

					</td>
					<td>
					</td>
				</tr>
				<tr>
					<td>
						<input name="allPurposeHide" id="allPurposeHide2" value="true" #if($!value_allPurposeHide)checked="checked"#end type="radio" />
					</td>
					<td colspan="4">
						<label for="allPurposeHide2">
							$tlang.getString("allPurpose.show.hide")
						</label>
					</td>
				</tr>
			</table>
			<h4><span class="reqStar">*</span>$tlang.getString("allPurpose.show.to")</h4>
			<div class="validationError alertMessage" id="allPurpose_userselect">
				$tlang.getString("extraNodesRequired")
			</div>	
			<table border="0" cellpadding="0" cellspacing="0" class="listHier" style="margin:1em 0;width:100%"  id="allPurposeGroupLists">
				<tbody>
					#set ($roleCount=0)
					#foreach ($role in $!roleUsers.keySet())

						#set ($roleCount=$roleCount + 1)
						#set($expandString=$tlang.getString("allPurpose.show.expand").concat(" ").concat($role).concat(" ").concat($tlang.getString("allPurpose.show.list")))
						#set($collapseString=$tlang.getString("allPurpose.show.collapse").concat(" ").concat($role).concat(" ").concat($tlang.getString("allPurpose.show.list")))
						#set($expandId = "expand_")
						#set($expandId = $expandId.concat($role))
						#set($collapseId="collapse_")
						#set($collapseId=$collapseId.concat($role))
						#set($roleDivString = $role.concat("Div"))
						#set($showInputString = "allPurpose_")
	            		#set($showInputString = $showInputString.concat($role))
						<tr>
							<td class="groupCell">					
								<a href="#" id="collapse_$roleCount" class="toggleRoleLink" style="display:none;" title="$collapseString">
									<img src="/library/image/sakai/collapse.gif" alt="$collapseString" /><img src="/library/image/silk/group.png"/>
								</a>
								<a href="#" id="expand_$roleCount" class="toggleRoleLink" style="display:inline" title="$expandString">
									<img src="/library/image/sakai/expand.gif"  alt="$expandString"/><img src="/library/image/silk/group.png"/>
								</a>
								<input id="$showInputString" name="showInputString_$roleCount" #if ($!value_allPurposeAccessList.contains($role)) checked="checked" #end type="checkbox" name="allPurpose_$role" class="selectAllMembers"/>
								<label for="showInputString_$roleCount">
									$role
								</label>
								(<span class="highlight countDisplay"></span> <span class="highlight">$tlang.getString("allPurpose.user.selection.count")</span>)
								<ul id="roleDiv_$roleCount"  style="display:none;" class="attachList userList">
									#set($userCount=0)
									#foreach($user in $!roleUsers.get($role))
										#set($showInputString = "allPurpose_")
										#set($showInputString = $showInputString.concat($user.getId()))
										<li>
											<label for="$showInputString" style="white-space:nowrap;padding:2px;width:90%;display:block" #if ($!value_allPurposeAccessList.contains($user.getId())) class="selectedItem" #end>
												<input id="$showInputString" name="$showInputString" #if ($!value_allPurposeAccessList.contains($user.getId())) class="selectedItem" checked="checked" #set($userCount=$userCount + 1) #end type="checkbox" value="$user.Id"/>
												$validator.escapeHtml($user.getDisplayName())
											</label>
										</li>
									#end
									<li class="countHolder" class="skip" style="display:none">$userCount</li>
								</ul>
							</td>
						</tr>	
					#end
				</tbody>
			</table>	
			<p class="act" style="margin:0;padding:0">
				<input class="extraNodeInput" type="button" id="allPurpose_save" value="$tlang.getString("allPurpose_save")" class="active"/>
				<input class="extraNodeInput" type="button" id ="allPurpose_cancel" value="$tlang.getString("allPurpose_cancel")" />
			</p>
		</fieldset>
		#set($submitnotif="submitnotifBottom")
		#buttonBar($submitnotif)
		<input type="hidden" name="sakai_csrf_token" value="$sakai_csrf_token" />
	</form>
	<script type="text/JavaScript">
		<!--
			function toggleSelectAll(caller, elementName)
			{
				var newValue = caller.checked;
				var elements = document.getElementsByName(elementName);
				
				if(elements)
				{
					for(var i = 0; i < elements.length; i++)
					{
						elements[i].checked = newValue;
					}
				}
			}
		-->
	</script>
</div>	
<!-- end: chef_assignments_instructor_new_edit_assignment.vm  -->
