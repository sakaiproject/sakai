<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">

   <!-- Bring in the hibernate related beans -->
   <import resource="spring-hibernate.xml" />
   <import resource="sakai-hibernate.xml" />

   <!-- Public beans -->
   <bean id="org.sakaiproject.hierarchy.HierarchyService" 
         class="org.sakaiproject.hierarchy.impl.HierarchyServiceImpl" init-method="init">
      <property name="nodeMetaRepository" ref="org.sakaiproject.hierarchy.api.repository.HierarchyNodeMetaDataRepository" />
      <property name="nodeRepository" ref="org.sakaiproject.hierarchy.api.repository.HierarchyPersistentNodeRepository" />
      <property name="permissionRepository" ref="org.sakaiproject.hierarchy.api.repository.HierarchyNodePermissionRepository" />
      <property name="sqlService" ref="org.sakaiproject.db.api.SqlService" />
      <property name="memoryService" ref="org.sakaiproject.memory.api.MemoryService" />
   </bean>

   <!-- Enable annotation-driven transactions for service methods -->
   <tx:annotation-driven transaction-manager="org.sakaiproject.springframework.orm.hibernate.GlobalTransactionManager"/>

   <!-- Repository beans -->
   <bean id="org.sakaiproject.hierarchy.api.repository.HierarchyNodeMetaDataRepository"
         class="org.sakaiproject.hierarchy.impl.repository.HierarchyNodeMetaDataRepositoryImpl">
      <property name="sessionFactory" ref="org.sakaiproject.springframework.orm.hibernate.GlobalSessionFactory" />
   </bean>

   <bean id="org.sakaiproject.hierarchy.api.repository.HierarchyPersistentNodeRepository"
         class="org.sakaiproject.hierarchy.impl.repository.HierarchyPersistentNodeRepositoryImpl">
      <property name="sessionFactory" ref="org.sakaiproject.springframework.orm.hibernate.GlobalSessionFactory" />
   </bean>

   <bean id="org.sakaiproject.hierarchy.api.repository.HierarchyNodePermissionRepository"
         class="org.sakaiproject.hierarchy.impl.repository.HierarchyNodePermissionRepositoryImpl">
      <property name="sessionFactory" ref="org.sakaiproject.springframework.orm.hibernate.GlobalSessionFactory" />
   </bean>

</beans>
