<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:panelGroup rendered="#{delivery.actionString != 'reviewAssessment'}">
        <h:panelGroup layout="block" styleClass="audio-recorder-header">
            <h:outputFormat value="#{deliveryMessages.audio_recorder_header}" escape="false" />
        </h:panelGroup>

        <h:panelGroup layout="block" styleClass="audio-recorder-container" id="audio-recorder">
            <h:panelGroup styleClass="sakai-recorder-error sak-banner-error" layout="block" style="display:none">
                <h:outputFormat value="#{deliveryMessages.audio_not_allowed} " escape="false" />
            </h:panelGroup>

            <div class="audio-popup-question">
                <h:outputFormat value="#{deliveryMessages.q} " />
                <h:outputText value="#{question.number}" escape="false" />
                <h:outputFormat value=" #{deliveryMessages.of} " />
                <h:outputText value="#{part.questions}" escape="false" />
            </div>

            <h:panelGroup styleClass="audio-popup-question-text" layout="block">
                <h:outputText value="#{question.text} " escape="false" />
            </h:panelGroup>

            <div class="audio-recorder-intro">
                <div class="time-allowed">
                    <h:outputFormat value=" #{deliveryMessages.audio_recorder_timelimit}" escape="false">
                        <f:param value="&lt;span class='audio-time-allowed'&gt; &lt;/span&gt;" />
                    </h:outputFormat>
                </div>
                <div class="attempts-allowed">
                    <h:outputFormat value=" #{deliveryMessages.audio_recorder_attempts_allowed} " escape="false" />
                    <span class="audio-attempts-allowed"> </span>
                </div>
                <div class="attempts-remaining">
                    <h:outputFormat value=" #{deliveryMessages.audio_recorder_attempts_remaining} " escape="false" />
                    <span class="audio-attempts"> </span>
                    <span class="audio-last-attempt" style="display:none">
                        <h:outputFormat value=" #{deliveryMessages.audio_recorder_last_attempt} " escape="false" />
                    </span>
                </div>
            </div>

            <h:panelGroup layout="block" styleClass="audio-browser-plea" style="display:none">
                <h:outputFormat value=" #{deliveryMessages.audio_recorder_browser_plea}" />
            </h:panelGroup>

            <h:panelGroup layout="block" styleClass="audio-visual-container">
                <h:panelGroup layout="block" id="audio-analyzer" styleClass="audio-analyzer" />
                <h:panelGroup layout="block" id="playback-analyzer" styleClass="playback-analyzer" style="display:none" />

                <div class="audio-controls">
                    <div class="audio-statusbar" style="display:none"> </div>
                    <div class="audio-levelbar"> </div>
                    <div class="audio-timer-wrapper">
                        <span class="audio-timer">0:00</span>
                        <div class="audio-scrubber"> </div>
                        <span class="audio-max-time">30</span>
                    </div>
                    <button class="audio-record">
                        <h:outputFormat value=" #{deliveryMessages.audio_recorder_record}" />
                    </button>
                    <button class="audio-stop" disabled="disabled">
                        <h:outputFormat value=" #{deliveryMessages.audio_recorder_stop}" />
                    </button>
                    <button class="audio-play" disabled="disabled">
                        <h:outputFormat value=" #{deliveryMessages.audio_recorder_play}" />
                    </button>
                    <button class="btn btn-primary text-white audio-upload" disabled="disabled">
                        <h:outputFormat value=" #{deliveryMessages.audio_recorder_post}" />
                    </button>
                </div>

                <div class="audio-mic-check" style="display:none">
                    <canvas class="volumemeter" width="16" height="54" style="background-color:#555;display:none"></canvas>
                    <button class="mic-check" onclick="microphoneCheck(this)" disabled="disabled"> </button>
                    <span>
                        <h:outputFormat value=" #{deliveryMessages.audio_mic_check}" />
                    </span>
                </div>
            </h:panelGroup>

            <audio class="audio-html5" style="display:none"> </audio>
            <div class="audio-debug-log" style="display:none">
                <h2>Log</h2>
                <pre class="log"></pre>
            </div>
        </h:panelGroup>
    </h:panelGroup>

</ui:composition>
